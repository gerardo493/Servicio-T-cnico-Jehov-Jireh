x    {% extends "base.html" %}

    {% block title %}Inicio - Sistema de Facturación{% endblock %}

    {% block content %}
    <style>
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0a0a0a 100%);
            min-height: 100vh;
        }
        .main-bg-blur {
            display: none;
        }
        .container-fluid.px-4 {
            position: relative;
            z-index: 1;
        }
        .stats-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            height: 100%;
            border: none;
            border-radius: 8px;
            overflow: hidden;
            background: #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }
        .stats-icon {
            transition: transform 0.3s ease;
            color: #2c3e50;
        }

        .stats-card:hover .stats-icon {
            transform: scale(1.1);
        }

        .card-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 1rem;
        }

        .display-4 {
            font-weight: 700;
            color: #2c3e50;
        }

        .quick-actions .btn {
            border: none;
            border-radius: 12px;
            padding: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 12px rgba(0, 255, 136, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            font-size: 0.9rem;
            color: #1a1a1a;
        }
        .quick-actions .btn-primary {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            color: #1a1a1a;
            border: 2px solid #00ff88;
        }
        .quick-actions .btn-success {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            color: #1a1a1a;
            border: 2px solid #00ff88;
        }
        .quick-actions .btn-warning {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            color: #1a1a1a;
            border: 2px solid #00ff88;
        }
        .quick-actions .btn-info {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            color: #1a1a1a;
            border: 2px solid #00ff88;
        }
        .quick-actions .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 255, 136, 0.4);
            background: linear-gradient(135deg, #00ff88 0%, #00e676 100%);
            filter: brightness(1.1);
        }
        .quick-actions .btn i {
            font-size: 1.2rem;
            margin-right: 0.5rem;
            transition: transform 0.3s;
        }
        .quick-actions .btn:hover i {
            transform: scale(1.1);
        }
        .list-group-item {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-radius: 8px !important;
            margin-bottom: 8px;
            border: 1px solid rgba(26, 26, 26, 0.2);
            background: rgba(26, 26, 26, 0.1);
            animation: list-item-glow 6s ease-in-out infinite;
        }

        @keyframes list-item-glow {
            0%, 100% { box-shadow: 0 2px 8px rgba(26, 26, 26, 0.1); }
            50% { box-shadow: 0 4px 12px rgba(26, 26, 26, 0.15); }
        }

        .list-group-item:hover {
            transform: translateX(10px) scale(1.02) rotate(1deg);
            box-shadow: 0 8px 20px rgba(26, 26, 26, 0.3), 0 0 15px rgba(26, 26, 26, 0.2);
            background: rgba(26, 26, 26, 0.2);
            animation: list-item-bounce 0.6s ease-in-out infinite;
        }

        @keyframes list-item-bounce {
            0%, 100% { transform: translateX(10px) scale(1.02) rotate(1deg); }
            50% { transform: translateX(12px) scale(1.03) rotate(2deg); }
        }

        /* Estilos mejorados para iconos */
        .fas, .far, .fab {
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .icon i, .icon-container i {
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        .btn i {
            margin-right: 0.5rem;
            transition: transform 0.3s ease;
        }

        .btn:hover i {
            transform: scale(1.1);
        }

        /* Iconos específicos con efectos especiales */
        .fa-dollar-sign, .fa-money-bill-wave, .fa-file-invoice-dollar, .fa-calculator {
            background: linear-gradient(45deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            padding: 0.5rem;
            border-radius: 50%;
            box-shadow: inset 0 1px 3px rgba(255,255,255,0.2);
        }

        .fa-user-friends, .fa-warehouse, .fa-file-alt, .fa-chart-line {
            background: linear-gradient(45deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            padding: 0.3rem;
            border-radius: 50%;
            box-shadow: inset 0 1px 3px rgba(255,255,255,0.2);
        }

        /* Colores blancos y amarillos para iconos de tarjetas principales - SIEMPRE VISIBLES */
        .icon-container.clientes i {
            color: #FFFFFF !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-block !important;
        }

        .icon-container.inventario i {
            color: #FFFFFF !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-block !important;
        }

        .icon-container.facturas i {
            color: #FFFFFF !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-block !important;
        }

        .icon-container.tasa-bcv i {
            color: #FFFFFF !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-block !important;
        }

        /* Asegurar que los contenedores de iconos sean siempre visibles */
        .icon-container {
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-flex !important;
        }

        /* Colores blancos y amarillos para iconos de botones */
        .btn-primary i {
            color: #FFFFFF !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .btn-success i {
            color: #FFD700 !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .btn-warning i {
            color: #FFA500 !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .btn-info i {
            color: #FFFF00 !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* Efectos de hover mejorados para iconos */
        .icon-container:hover i {
            transform: scale(1.3) rotate(8deg);
            filter: brightness(1.4) drop-shadow(0 6px 12px rgba(0,0,0,0.4));
            text-shadow: 0 0 10px rgba(255,255,255,0.8);
        }

        .btn:hover i {
            transform: scale(1.2) rotate(5deg);
            filter: brightness(1.3) drop-shadow(0 4px 8px rgba(0,0,0,0.3));
        }

        /* Efectos de brillo adicionales para iconos blancos y amarillos - SIEMPRE VISIBLES */
        .icon i {
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-block !important;
        }

        .icon i::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 120%;
            height: 120%;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: -1;
            opacity: 1;
            transition: opacity 0.3s ease;
        }

        .icon:hover i::before {
            opacity: 1.2;
        }

        /* Asegurar que los iconos sean siempre visibles */
        .icon {
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-flex !important;
        }

        .icon i {
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-block !important;
        }

        /* Iconos de estado con colores suaves */
        .fa-check-circle {
            color: #4CAF50 !important;
        }

        .fa-exclamation-circle {
            color: #FF9800 !important;
        }

        .fa-clock {
            color: #9E9E9E !important;
        }

        .fa-sync-alt {
            color: #00ff88 !important;
        }

        /* Estilos para el desplegable de filtros de pagos */
        .header-stat-card .dropdown-toggle {
            background: rgba(26, 26, 26, 0.2) !important;
            border: 1px solid rgba(255, 255, 255, 0.3) !important;
            color: #1a1a1a !important;
            border-radius: 8px !important;
            transition: all 0.3s ease !important;
        }

        .header-stat-card .dropdown-toggle:hover {
            background: rgba(26, 26, 26, 0.4) !important;
            border-color: rgba(255, 255, 255, 0.5) !important;
            transform: scale(1.05) !important;
        }

        .header-stat-card .dropdown-toggle:focus {
            box-shadow: 0 0 0 0.2rem rgba(0, 255, 136, 0.25) !important;
        }

        .header-stat-card .dropdown-menu {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%) !important;
            border: 2px solid #00ff88 !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0, 255, 136, 0.3) !important;
            padding: 0.5rem 0 !important;
        }

        .header-stat-card .dropdown-item {
            color: #ffffff !important;
            padding: 0.5rem 1rem !important;
            transition: all 0.3s ease !important;
            border-radius: 8px !important;
            margin: 0.1rem 0.5rem !important;
        }

        .header-stat-card .dropdown-item:hover {
            background: linear-gradient(90deg, #00ff88 0%, #00cc6a 100%) !important;
            color: #1a1a1a !important;
            transform: translateX(5px) !important;
        }

        .header-stat-card .dropdown-item i {
            color: #00ff88 !important;
            transition: color 0.3s ease !important;
        }

        .header-stat-card .dropdown-item:hover i {
            color: #1a1a1a !important;
        }

        .header-stat-card .dropdown-divider {
            border-color: rgba(0, 255, 136, 0.3) !important;
            margin: 0.5rem 0 !important;
        }

        /* Estilos mejorados para las listas de facturas y productos */
        .list-group-item {
            border: none !important;
            background: transparent !important;
            padding: 1rem !important;
            margin-bottom: 0.5rem !important;
            border-radius: 12px !important;
            transition: all 0.3s ease !important;
        }

        .list-group-item:hover {
            background: rgba(0, 255, 136, 0.1) !important;
            transform: translateX(8px) !important;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.2) !important;
        }

        .list-group-item h6 {
            font-size: 1rem !important;
            margin-bottom: 0.25rem !important;
        }

        .list-group-item small {
            font-size: 0.8rem !important;
        }

        .fw-bold {
            font-weight: 700 !important;
        }

        .text-success {
            color: #00ff88 !important;
        }

        .text-warning {
            color: #ffc107 !important;
        }

        .text-primary {
            color: #00ff88 !important;
        }

        .badge {
            font-size: 0.75rem !important;
            padding: 0.4rem 0.6rem !important;
            border-radius: 8px !important;
        }

        .bg-danger {
            background: linear-gradient(135deg, #dc3545, #c82333) !important;
        }

        /* Estilos mejorados para la sección de facturas simplificada */
        .factura-item {
            border-left: 4px solid transparent !important;
            transition: all 0.3s ease !important;
            position: relative !important;
            padding: 1rem !important;
        }

        .factura-item[data-estado="pagada"] {
            border-left-color: #00ff88 !important;
            background: rgba(0, 255, 136, 0.05) !important;
        }

        .factura-item[data-estado="pendiente"] {
            border-left-color: #ffc107 !important;
            background: rgba(255, 193, 7, 0.05) !important;
        }

        .factura-item:hover {
            transform: translateX(8px) scale(1.02) !important;
            box-shadow: 0 8px 25px rgba(0, 255, 136, 0.15) !important;
            background: rgba(0, 255, 136, 0.1) !important;
        }

        .factura-item h6 {
            font-size: 1rem !important;
            font-weight: 700 !important;
            margin-bottom: 0.25rem !important;
            color: #1a1a1a !important;
        }

        .factura-item .text-dark {
            color: #1a1a1a !important;
            font-weight: 600 !important;
        }

        .factura-item small {
            font-size: 0.8rem !important;
            color: #1a1a1a !important;
        }

        .factura-item .fw-bold {
            color: #1a1a1a !important;
            font-weight: 700 !important;
        }

        .factura-item i {
            font-size: 1rem !important;
        }

        /* Animación de entrada */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Estilos para el footer de la tarjeta */
        .card-footer {
            background: rgba(26, 26, 26, 0.1) !important;
            border-top: 1px solid rgba(26, 26, 26, 0.2) !important;
            padding: 1rem !important;
        }

        .card-footer .btn {
            border-radius: 8px !important;
            font-weight: 600 !important;
            transition: all 0.3s ease !important;
        }

        .card-footer .btn:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3) !important;
        }

        /* Mejorar el header de la tarjeta */
        .card-header h5 i {
            color: #00ff88 !important;
        }

        .card-header .dropdown-toggle {
            background: rgba(0, 255, 136, 0.1) !important;
            border: 1px solid rgba(0, 255, 136, 0.3) !important;
            color: #1a1a1a !important;
            font-weight: 600 !important;
        }

        .card-header .dropdown-toggle:hover {
            background: rgba(0, 255, 136, 0.2) !important;
            border-color: rgba(0, 255, 136, 0.5) !important;
        }

        /* Asegurar que todos los iconos se muestren correctamente */
        .fas, .far, .fab {
            font-family: "Font Awesome 5 Free" !important;
            font-weight: 900 !important;
            font-style: normal !important;
            font-variant: normal !important;
            text-rendering: auto !important;
            -webkit-font-smoothing: antialiased !important;
            -moz-osx-font-smoothing: grayscale !important;
        }

        /* Estilos específicos para iconos problemáticos */
        .fa-file-alt::before {
            content: "\f15c" !important;
        }

        .fa-chart-line::before {
            content: "\f201" !important;
        }

        .fa-user-friends::before {
            content: "\f500" !important;
        }

        .fa-warehouse::before {
            content: "\f494" !important;
        }

        /* Códigos Unicode para iconos de métricas del header */
        .fa-dollar-sign::before {
            content: "\f155" !important;
        }

        .fa-money-bill-wave::before {
            content: "\f53a" !important;
        }

        .fa-file-invoice-dollar::before {
            content: "\f571" !important;
        }

        .fa-calculator::before {
            content: "\f1ec" !important;
        }

        /* Asegurar que los iconos de métricas del header sean siempre visibles */
        .header-stat-card .icon {
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-flex !important;
        }

        .header-stat-card .icon i {
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-block !important;
            font-size: 2.2rem !important;
        }

        /* Forzar visibilidad de todos los iconos Font Awesome */
        .fas, .far, .fab {
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-block !important;
        }

        /* Paleta de colores blancos y amarillos para iconos */
        :root {
            --verde-principal: #00ff88;
            --blanco-icono: #FFFFFF;
            --amarillo-dorado: #FFD700;
            --naranja-brillante: #FFA500;
            --amarillo-limón: #FFFF00;
            --negro-principal: #1a1a1a;
            --gris-suave: #9E9E9E;
            --naranja-suave: #FF9800;
        }

        /* Gradientes suaves para iconos */
        .icon {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border-radius: 50%;
            padding: 0.8rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .icon:hover {
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
        }

        /* Efectos de brillo para iconos */
        .icon i {
            position: relative;
            z-index: 2;
        }

        .icon::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 1;
        }

        .list-group-item h6 {
            font-weight: 600;
            color: #1a1a1a;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .list-group-item p {
            color: #1a1a1a;
            opacity: 0.8;
        }

        .list-group-item small {
            color: #1a1a1a !important;
            opacity: 0.7;
        }

        .list-group-item .text-muted {
            color: #1a1a1a !important;
            opacity: 0.7;
        }

        .card {
            border: 2px solid #00ff88;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 255, 136, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            animation: card-gentle-float 10s ease-in-out infinite;
        }

        @keyframes card-gentle-float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-2px) rotate(0.5deg); }
            50% { transform: translateY(-4px) rotate(0deg); }
            75% { transform: translateY(-2px) rotate(-0.5deg); }
        }

        .card:hover {
            box-shadow: 0 20px 50px rgba(0, 255, 136, 0.4), 0 0 30px rgba(0, 255, 136, 0.2);
            transform: translateY(-10px) scale(1.02) rotate(1deg);
            background: linear-gradient(135deg, #00ff88 0%, #00e676 100%);
            animation: card-hover-dance 1.2s ease-in-out infinite;
        }

        @keyframes card-hover-dance {
            0%, 100% { transform: translateY(-10px) scale(1.02) rotate(1deg); }
            25% { transform: translateY(-12px) scale(1.03) rotate(2deg); }
            50% { transform: translateY(-14px) scale(1.04) rotate(1deg); }
            75% { transform: translateY(-12px) scale(1.03) rotate(0deg); }
        }

        .card-header {
            background: rgba(26, 26, 26, 0.1);
            border-bottom: 1px solid rgba(26, 26, 26, 0.2);
            border-radius: 10px 10px 0 0 !important;
            padding: 1rem;
        }

        .card-header h5 {
            font-weight: 700;
            color: #1a1a1a;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        #fecha-hora-actual {
            background: linear-gradient(145deg, #00ff88, #00cc6a);
            padding: 1.2rem 2rem;
            border-radius: 16px;
            color: #1a1a1a;
            font-weight: 700;
            font-size: 1.1rem;
            border: 2px solid #00ff88;
            box-shadow: 
                8px 8px 20px rgba(0, 255, 136, 0.4),
                -8px -8px 20px rgba(0, 204, 106, 0.3),
                inset 2px 2px 4px rgba(255, 255, 255, 0.3),
                inset -2px -2px 4px rgba(0, 0, 0, 0.1),
                0 0 20px rgba(0, 255, 136, 0.3);
            text-align: center;
            margin-left: 0;
            white-space: normal;
            word-break: break-word;
            backdrop-filter: blur(10px);
            transform: translateY(0) translateZ(0);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            perspective: 1000px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        #fecha-hora-actual::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, 
                rgba(0, 255, 136, 0) 0%, 
                rgba(255, 255, 255, 0.4) 50%, 
                rgba(0, 255, 136, 0) 100%);
            box-shadow: 0 1px 2px rgba(0, 255, 136, 0.3);
        }

        #fecha-hora-actual::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, 
                rgba(0, 204, 106, 0) 0%, 
                rgba(0, 204, 106, 0.4) 50%, 
                rgba(0, 204, 106, 0) 100%);
            box-shadow: 0 -1px 2px rgba(0, 204, 106, 0.2);
        }

        #fecha-hora-actual:hover {
            transform: translateY(-4px) translateZ(20px);
            box-shadow: 
                12px 12px 30px rgba(0, 255, 136, 0.5),
                -12px -12px 30px rgba(0, 204, 106, 0.4),
                inset 2px 2px 4px rgba(255, 255, 255, 0.4),
                inset -2px -2px 4px rgba(0, 0, 0, 0.1),
                0 0 30px rgba(0, 255, 136, 0.4);
            color: #1a1a1a;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        #fecha-hora-actual:active {
            transform: translateY(-2px) translateZ(10px);
            box-shadow: 
                6px 6px 15px rgba(0, 255, 136, 0.4),
                -6px -6px 15px rgba(0, 204, 106, 0.3),
                inset 1px 1px 2px rgba(255, 255, 255, 0.3),
                inset -1px -1px 2px rgba(0, 0, 0, 0.1),
                0 0 15px rgba(0, 255, 136, 0.3);
        }

        @media (max-width: 768px) {
            #fecha-hora-actual {
                font-size: 0.95rem;
                padding: 1rem 1.5rem;
                margin: 1rem 0;
                border-radius: 14px;
            }
        }

        @media (max-width: 576px) {
            #fecha-hora-actual {
                font-size: 0.85rem;
                padding: 0.8rem 1.2rem;
                border-radius: 12px;
            }
        }

        .text-muted {
            color: #6c757d !important;
        }

        .text-danger {
            color: #dc3545 !important;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .display-4 {
                font-size: 2rem;
            }

            .stats-card {
                margin-bottom: 1rem;
            }

            .quick-actions .btn {
                margin-bottom: 0.5rem;
            }

            .list-group-item {
                padding: 0.75rem;
            }

            .card-header {
                padding: 0.75rem;
            }
        }

        @media (max-width: 576px) {
            .display-4 {
                font-size: 1.5rem;
            }

            .stats-card .card-body {
                padding: 1rem;
            }

            .welcome-text {
                font-size: 1.2rem;
            }

            .welcome-subtext {
                font-size: 0.9rem;
            }
        }

        .header-container {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 50%, #1a1a1a 100%);
            padding: 2.5rem 0 2rem 0;
            margin: -1.5rem -1.5rem 0 -1.5rem;
            border-radius: 0 0 40px 40px;
            box-shadow: 0 12px 32px rgba(0, 255, 136, 0.2);
            position: relative;
            overflow: visible;
            border-bottom: 3px solid #00ff88;
        }

        .header-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.5;
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header-logo {
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s;
            background: transparent;
            border: none;
            border-radius: 50%;
            width: 160px;
            height: 160px;
            position: relative;
            cursor: pointer;
        }

        .header-logo:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .header-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            background: transparent;
        }

        .header-logo:hover img {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        @media (max-width: 991px) {
            .header-logo {
                width: 120px;
                height: 120px;
            }
        }

        @media (max-width: 576px) {
            .header-logo {
                width: 100px;
                height: 100px;
            }
        }

        .welcome-text {
            color: #00ff88;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            letter-spacing: 0.5px;
            line-height: 1.2;
            text-shadow: 0 2px 8px rgba(0, 255, 136, 0.3), 0 0 20px rgba(0, 255, 136, 0.2);
        }

        .welcome-subtext {
            color: #ffffff;
            font-size: 1.3rem;
            font-weight: 500;
            margin-bottom: 0;
            letter-spacing: 0.3px;
            line-height: 1.4;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        .main-stats {
            margin-top: 2.5rem;
        }
        .main-stats .card {
            flex: 1 1 0;
            min-width: 180px;
            max-width: 260px;
            margin: 0;
            border: 2px solid #00ff88;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 255, 136, 0.15);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background: #ffffff;
            animation: card-float 8s ease-in-out infinite;
        }

        @keyframes card-float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-3px) rotate(1deg); }
            50% { transform: translateY(-6px) rotate(0deg); }
            75% { transform: translateY(-3px) rotate(-1deg); }
        }
        .main-stats .card:hover {
            transform: translateY(-15px) scale(1.08) rotate(3deg);
            box-shadow: 0 25px 60px rgba(0, 255, 136, 0.5), 0 0 40px rgba(0, 255, 136, 0.3);
            background: #ffffff;
            border-color: #00e676;
            animation: card-dance 1s ease-in-out infinite;
        }

        @keyframes card-dance {
            0%, 100% { transform: translateY(-15px) scale(1.08) rotate(3deg); }
            25% { transform: translateY(-18px) scale(1.1) rotate(5deg); }
            50% { transform: translateY(-20px) scale(1.12) rotate(3deg); }
            75% { transform: translateY(-18px) scale(1.1) rotate(1deg); }
        }
        .main-stats .icon-container {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            font-size: 2.1rem;
            margin-bottom: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 16px rgba(26, 26, 26, 0.2);
            background: rgba(26, 26, 26, 0.1);
            border: 1px solid rgba(26, 26, 26, 0.3);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: icon-float 4s ease-in-out infinite;
        }

        @keyframes icon-float {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.05) rotate(3deg); }
            50% { transform: scale(1.1) rotate(0deg); }
            75% { transform: scale(1.05) rotate(-3deg); }
        }
        .main-stats .card:hover .icon-container {
            transform: scale(1.4) rotate(-15deg) translateY(-8px);
            box-shadow: 0 12px 30px rgba(26, 26, 26, 0.4), 0 0 20px rgba(26, 26, 26, 0.3);
            background: rgba(26, 26, 26, 0.2);
            border-color: rgba(26, 26, 26, 0.6);
            animation: icon-spin 0.8s ease-in-out infinite;
        }
        .main-stats .stat-title {
            font-size: 1.18rem;
            font-weight: 700;
            margin-bottom: 0.3rem;
            letter-spacing: 0.7px;
            color: #1a1a1a;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .main-stats .stat-value {
            font-size: 1.55rem;
            font-weight: 800;
            margin-bottom: 0.1rem;
            color: #1a1a1a;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .main-stats .stat-subtitle {
            font-size: 1.13rem;
            font-weight: 600;
            color: #1a1a1a;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        .card.clientes .icon-container {
            background: linear-gradient(135deg, #00ff88 0%, #00e676 100%);
            color: #ffffff;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);
            margin: 0 auto 1rem;
        }
        .card.inventario .icon-container {
            background: linear-gradient(135deg, #00ff88 0%, #00e676 100%);
            color: #ffffff;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);
            margin: 0 auto 1rem;
        }
        .card.facturas .icon-container {
            background: linear-gradient(135deg, #00ff88 0%, #00e676 100%);
            color: #ffffff;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);
            margin: 0 auto 1rem;
        }
        .card.tasa-bcv .icon-container {
            background: linear-gradient(135deg, #00ff88 0%, #00e676 100%);
            color: #ffffff;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);
            margin: 0 auto 1rem;
        }
        .card.clientes .stat-title {
            color: #00ff88;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 255, 136, 0.3);
        }
        .card.inventario .stat-title {
            color: #00ff88;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 255, 136, 0.3);
        }
        .card.facturas .stat-title {
            color: #00ff88;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 255, 136, 0.3);
        }
        .card.tasa-bcv .stat-title {
            color: #00ff88;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 255, 136, 0.3);
        }
        .card.clientes .stat-value {
            color: #1a1a1a;
            font-weight: 800;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .card.inventario .stat-value {
            color: #1a1a1a;
            font-weight: 800;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .card.facturas .stat-value {
            color: #1a1a1a;
            font-weight: 800;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .card.tasa-bcv .stat-value {
            color: #1a1a1a;
            font-weight: 800;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .card.clientes .stat-subtitle {
            color: #6c757d;
            font-weight: 500;
        }
        .card.inventario .stat-subtitle {
            color: #6c757d;
            font-weight: 500;
        }
        .card.facturas .stat-subtitle {
            color: #6c757d;
            font-weight: 500;
        }
        .card.tasa-bcv .stat-subtitle {
            color: #6c757d;
            font-weight: 500;
        }
        .badge {
            background-color: rgba(255, 255, 255, 0.95) !important;
            color: #1a237e !important;
            border: 1px solid rgba(26, 35, 126, 0.1);
        }
        .badge.bg-warning {
            color: #FFC107 !important;
        }
        .badge.bg-primary {
            color: #1976d2 !important;
        }
        #ultima-actualizacion-dashboard {
            color: #ffc107 !important;
            font-weight: 700 !important;
            text-shadow: 0 1px 3px rgba(255, 193, 7, 0.5) !important;
            background: rgba(255, 193, 7, 0.1) !important;
            padding: 8px 12px !important;
            border-radius: 12px !important;
            border: 1px solid rgba(255, 193, 7, 0.3) !important;
            font-size: 0.85rem !important;
        }
        .main-stats-carousel {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            justify-content: space-between;
            align-items: stretch;
            width: 100%;
        }
        @media (max-width: 991px) {
            .welcome-text {
                font-size: 1.3rem;
            }
            .header-container {
                padding: 1.2rem 0 1.2rem 0;
                border-radius: 0 0 24px 24px;
            }
            .main-stats {
                margin-top: 1.2rem;
            }
        }
        @media (max-width: 576px) {
            .welcome-text {
                font-size: 1.1rem;
            }
            .header-container {
                padding: 0.7rem 0 0.7rem 0;
                border-radius: 0 0 14px 14px;
            }
            .main-stats {
                margin-top: 0.7rem;
            }
        }
        @media (max-width: 991px) {
            .main-stats-carousel {
                gap: 1rem;
            }
            .main-stats .card {
                min-width: 160px;
                max-width: 100%;
            }
        }
        @media (max-width: 768px) {
            .main-stats-carousel {
                flex-direction: column;
                gap: 0.7rem;
            }
            .main-stats .card {
                min-width: 100%;
                max-width: 100%;
            }
        }
        .header-stat-card {
            background: #ffffff;
            border: 2px solid #00ff88;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 255, 136, 0.15);
            padding: 1.5rem;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: center;
            position: relative;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-2px) rotate(0.5deg); }
            50% { transform: translateY(-4px) rotate(0deg); }
            75% { transform: translateY(-2px) rotate(-0.5deg); }
        }

        .header-stat-card.cobranza {
            background: #ffffff;
            border: 2px solid #00ff88;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 255, 136, 0.2);
        }

        .header-stat-card.cobranza::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%);
            border-radius: 50%;
            transform: translate(30%, -30%);
        }

        .header-stat-card.cobranza .icon {
            color: #1a1a1a;
            font-size: 2.6rem;
            margin-bottom: 1.2rem;
            background: rgba(26, 26, 26, 0.1);
            padding: 1.2rem;
            border-radius: 20px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 16px rgba(26, 26, 26, 0.2);
            border: 1px solid rgba(26, 26, 26, 0.3);
            animation: icon-bounce 3s ease-in-out infinite;
        }

        @keyframes icon-bounce {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.05) rotate(2deg); }
            50% { transform: scale(1.1) rotate(0deg); }
            75% { transform: scale(1.05) rotate(-2deg); }
        }

        .header-stat-card.cobranza:hover .icon {
            transform: scale(1.3) rotate(-15deg) translateY(-5px);
            box-shadow: 0 12px 30px rgba(26, 26, 26, 0.4), 0 0 20px rgba(26, 26, 26, 0.3);
            background: rgba(26, 26, 26, 0.2);
            border-color: rgba(26, 26, 26, 0.6);
            animation: icon-spin 0.6s ease-in-out;
        }

        @keyframes icon-spin {
            0% { transform: scale(1.3) rotate(-15deg) translateY(-5px); }
            50% { transform: scale(1.4) rotate(-30deg) translateY(-8px); }
            100% { transform: scale(1.3) rotate(-15deg) translateY(-5px); }
        }

        .header-stat-card.cobranza .header-stat-label {
            color: #00ff88;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.8rem;
            text-shadow: 0 2px 4px rgba(0, 255, 136, 0.3);
        }

        .header-stat-card.cobranza .header-stat-value {
            color: #1a1a1a;
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header-stat-card.cobranza .header-stat-bs {
            font-size: 1.2rem;
            font-weight: 600;
            color: #6c757d;
            margin-top: 0.3rem;
            opacity: 0.8;
        }

        .header-stat-card.cobranza:hover {
            transform: translateY(-12px) scale(1.05) rotate(2deg);
            box-shadow: 0 20px 50px rgba(0, 255, 136, 0.5), 0 0 30px rgba(0, 255, 136, 0.3);
            background: #ffffff;
            border-color: #00e676;
            animation: pulse-glow 1.5s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 20px 50px rgba(0, 255, 136, 0.5), 0 0 30px rgba(0, 255, 136, 0.3); }
            50% { box-shadow: 0 25px 60px rgba(0, 255, 136, 0.6), 0 0 40px rgba(0, 255, 136, 0.4); }
        }

        .header-stat-card.pagos {
            background: #ffffff;
            border: 2px solid #00ff88;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 255, 136, 0.2);
        }

        .header-stat-card.pagos::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%);
            border-radius: 50%;
            transform: translate(30%, -30%);
        }

        .header-stat-card.pagos .icon {
            color: #1a1a1a;
            font-size: 2.6rem;
            margin-bottom: 1.2rem;
            background: rgba(26, 26, 26, 0.1);
            padding: 1.2rem;
            border-radius: 20px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 16px rgba(26, 26, 26, 0.2);
            border: 1px solid rgba(26, 26, 26, 0.3);
            animation: icon-bounce 3.2s ease-in-out infinite;
        }

        .header-stat-card.pagos:hover .icon {
            transform: scale(1.3) rotate(15deg) translateY(-5px);
            box-shadow: 0 12px 30px rgba(26, 26, 26, 0.4), 0 0 20px rgba(26, 26, 26, 0.3);
            background: rgba(26, 26, 26, 0.2);
            border-color: rgba(26, 26, 26, 0.6);
            animation: icon-spin 0.6s ease-in-out;
        }

        .header-stat-card.pagos .header-stat-label {
            color: #00ff88;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.8rem;
            text-shadow: 0 2px 4px rgba(0, 255, 136, 0.3);
        }

        .header-stat-card.pagos .header-stat-value {
            color: #1a1a1a;
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header-stat-card.pagos .header-stat-bs {
            font-size: 1.2rem;
            font-weight: 600;
            color: #6c757d;
            margin-top: 0.3rem;
            opacity: 0.8;
        }

        .header-stat-card.pagos:hover {
            transform: translateY(-12px) scale(1.05) rotate(-2deg);
            box-shadow: 0 20px 50px rgba(0, 255, 136, 0.5), 0 0 30px rgba(0, 255, 136, 0.3);
            background: #ffffff;
            border-color: #00e676;
            animation: pulse-glow 1.5s ease-in-out infinite;
        }

        .header-stat-card.facturado {
            background: #ffffff;
            border: 2px solid #00ff88;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 255, 136, 0.3);
        }

        .header-stat-card.facturado::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%);
            border-radius: 50%;
            transform: translate(30%, -30%);
        }

        .header-stat-card.facturado .icon {
            color: #1a1a1a;
            font-size: 2.6rem;
            margin-bottom: 1.2rem;
            background: rgba(26, 26, 26, 0.1);
            padding: 1.2rem;
            border-radius: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(26, 26, 26, 0.2);
            border: 1px solid rgba(26, 26, 26, 0.3);
        }

        .header-stat-card.facturado:hover .icon {
            transform: scale(1.1) rotate(-5deg);
            box-shadow: 0 8px 24px rgba(26, 26, 26, 0.3);
            background: rgba(26, 26, 26, 0.15);
            border-color: rgba(26, 26, 26, 0.5);
        }

        .header-stat-card.facturado .header-stat-label {
            color: #00ff88;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.8rem;
            text-shadow: 0 2px 4px rgba(0, 255, 136, 0.3);
        }

        .header-stat-card.facturado .header-stat-value {
            color: #1a1a1a;
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header-stat-card.facturado .header-stat-bs {
            font-size: 1.2rem;
            font-weight: 600;
            color: #6c757d;
            margin-top: 0.3rem;
            opacity: 0.8;
        }

        .header-stat-card.facturado:hover {
            transform: translateY(-12px) scale(1.05) rotate(1deg);
            box-shadow: 0 20px 50px rgba(0, 255, 136, 0.5), 0 0 30px rgba(0, 255, 136, 0.3);
            background: #ffffff;
            border-color: #00e676;
            animation: pulse-glow 1.5s ease-in-out infinite;
        }

        .header-stat-card.promedio {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            border: 2px solid #00ff88;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 255, 136, 0.3);
        }

        .header-stat-card.promedio::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%);
            border-radius: 50%;
            transform: translate(30%, -30%);
        }

        .header-stat-card.promedio .icon {
            color: #1a1a1a;
            font-size: 2.6rem;
            margin-bottom: 1.2rem;
            background: rgba(26, 26, 26, 0.1);
            padding: 1.2rem;
            border-radius: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(26, 26, 26, 0.2);
            border: 1px solid rgba(26, 26, 26, 0.3);
        }

        .header-stat-card.promedio:hover .icon {
            transform: scale(1.1) rotate(-5deg);
            box-shadow: 0 8px 24px rgba(26, 26, 26, 0.3);
            background: rgba(26, 26, 26, 0.15);
            border-color: rgba(26, 26, 26, 0.5);
        }

        .header-stat-card.promedio .header-stat-label {
            color: #1a1a1a;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.8rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header-stat-card.promedio .header-stat-value {
            color: #1a1a1a;
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header-stat-card.promedio .header-stat-bs {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1a1a1a;
            margin-top: 0.3rem;
            opacity: 0.8;
        }

        .header-stat-card.promedio:hover {
            transform: translateY(-12px) scale(1.05) rotate(-1deg);
            box-shadow: 0 20px 50px rgba(0, 255, 136, 0.5), 0 0 30px rgba(0, 255, 136, 0.3);
            background: linear-gradient(135deg, #00ff88 0%, #00e676 100%);
            animation: pulse-glow 1.5s ease-in-out infinite;
        }

        .header-stat-card.promedio .header-stat-refresh {
            color: #ff9800;
            font-size: 1.2rem;
            opacity: 0.8;
        }

        .header-stat-card.promedio:hover .header-stat-refresh {
            opacity: 1;
            transform: rotate(180deg);
            color: #ff9800;
        }

        .header-stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        }

        .header-stat-card .icon {
            font-size: 2.2rem;
            margin-bottom: 1rem;
            transition: transform 0.3s ease;
        }

        .header-stat-card.cobranza .icon {
            color: #dc3545;
        }

        .header-stat-card.pagos .icon {
            color: #28a745;
        }


        .header-stat-refresh {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.1rem;
            color: #6c757d;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0.7;
        }

        .header-stat-card.cobranza .header-stat-refresh {
            color: #dc3545;
        }

        .header-stat-card.pagos .header-stat-refresh {
            color: #28a745;
        }

        .header-stat-card:hover .header-stat-refresh {
            opacity: 1;
            transform: rotate(180deg);
        }

        @media (max-width: 768px) {
            .header-stat-card {
                padding: 1.2rem;
            }
            
            .header-stat-value {
                font-size: 1.5rem;
            }
            
            .header-stat-label {
                font-size: 1rem;
            }
            
            .header-stat-card .icon {
                font-size: 1.8rem;
                margin-bottom: 0.8rem;
            }
        }

        /* Estilos para filtros principales en esquina superior derecha */
        .filtro-principal {
            z-index: 10;
        }
        .filtro-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: #333;
            font-size: 0.75rem;
            padding: 4px 8px;
            border-radius: 6px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .filtro-btn:hover {
            background: rgba(255, 255, 255, 1);
            border-color: rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }
        .filtro-btn:focus {
            box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
        }
        
        /* Estilos mejorados para el modal de filtros con verde neón */
        .modal-content {
            border: 1px solid #00ff88;
            box-shadow: 0 20px 60px rgba(0,255,136,0.3);
        }
        
        .modal-header {
            border-bottom: 1px solid #00ff88;
        }
        
        .modal-body .form-select,
        .modal-body .form-control {
            border: 2px solid #00ff88;
            border-radius: 8px;
            transition: all 0.3s ease;
            background: #2d2d2d;
            color: #fff;
        }
        
        .modal-body .form-select:focus,
        .modal-body .form-control:focus {
            border-color: #00ff88;
            box-shadow: 0 0 0 0.2rem rgba(0, 255, 136, 0.25);
            background: #2d2d2d;
            color: #fff;
        }
        
        .modal-body .btn {
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .modal-body .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,255,136,0.3);
        }
        
        .modal-body .btn-outline-success:hover {
            background: rgba(0, 255, 136, 0.2);
            border-color: #00ff88;
            color: #00ff88;
        }

        /* Efectos hover para los iconos del dashboard */
        .icon-container:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 6px 20px rgba(0, 255, 136, 0.5);
            transition: all 0.3s ease;
        }
        
        .icon-container:hover i {
            transform: scale(1.2);
            transition: all 0.3s ease;
        }

        /* Estilos para métricas de crecimiento */
        .growth-metric {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 0.25rem;
        }

        .growth-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .growth-indicator.positive {
            background: linear-gradient(135deg, #00ff88 0%, #00e676 100%);
            color: #1a1a1a;
            box-shadow: 0 2px 8px rgba(0, 255, 136, 0.3);
        }

        .growth-indicator.negative {
            background: linear-gradient(135deg, #ff4757 0%, #ff3742 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(255, 71, 87, 0.3);
        }

        .growth-indicator.neutral {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(108, 117, 125, 0.3);
        }

        .growth-text {
            font-size: 0.75rem;
            color: #6c757d;
            font-weight: 500;
            opacity: 0.8;
        }

        .growth-indicator i {
            font-size: 0.7rem;
        }

        .filtro-menu {
            min-width: 200px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(0, 0, 0, 0.1);
            transform: translateY(-100%) !important;
            margin-top: -10px;
        }
        
        .filtro-menu.show {
            transform: translateY(-100%) !important;
        }
        
        .filtro-opcion {
            padding: 8px 16px;
            font-size: 0.875rem;
            transition: all 0.2s ease;
            color: #333;
        }
        .filtro-opcion:hover {
            background: #f8f9fa;
            color: #000;
        }
        .filtro-opcion i {
            width: 16px;
            text-align: center;
        }
        .filtro-opcion:hover i {
            color: #007bff;
        }
        
        .filtro-divider {
            margin: 4px 0;
            border-color: #dee2e6;
        }

        /* Estilos para selector de fecha y mes */
        .filtro-fecha, .filtro-mes {
            border: 1px solid #dee2e6;
            border-radius: 6px;
            transition: all 0.2s ease;
            background: white;
        }
        .filtro-fecha:focus, .filtro-mes:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
            outline: none;
        }
        .filtro-fecha:hover, .filtro-mes:hover {
            border-color: #0d6efd;
        }
        .filtro-mes {
            font-size: 0.8rem;
        }

        /* Indicador de filtro activo */
        .filtro-activo {
            background: linear-gradient(45deg, #28a745, #20c997) !important;
            color: white !important;
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.5) !important;
        }
        .filtro-activo .filtro-texto {
            font-weight: bold;
        }
        /* Animación de pulso para filtros activos */
        @keyframes pulse-filtro {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .filtro-pulsando {
            animation: pulse-filtro 0.6s ease-in-out;
        }

        /* Animaciones para transiciones suaves */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-10px); }
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        @keyframes loading {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .fadeIn { animation: fadeIn 0.3s ease-in-out; }
        .fadeOut { animation: fadeOut 0.3s ease-in-out; }
        .slideDown { animation: slideDown 0.3s ease-in-out; }
        .slideInRight { animation: slideInRight 0.3s ease-in-out; }
        .pulse { animation: pulse 0.6s ease-in-out; }
        .loading { animation: loading 1s linear infinite; }

        .carousel-control-prev,
        .carousel-control-next {
            color: rgba(0, 0, 0, 0.9);
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
        }

        .carousel-control-prev-icon,
        .carousel-control-next-icon {
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 50%;
            padding: 1.5rem;
        }

        .badge {
            background-color: rgba(255, 255, 255, 0.95) !important;
            color: #1a237e !important;
            border: 1px solid rgba(26, 35, 126, 0.1);
        }

        .badge.bg-warning {
            color: #FFC107 !important;
        }

        .badge.bg-primary {
            color: #1976d2 !important;
        }

        #ultima-actualizacion-dashboard {
            color: #ffc107 !important;
            font-weight: 700 !important;
            text-shadow: 0 1px 3px rgba(255, 193, 7, 0.5) !important;
            background: rgba(255, 193, 7, 0.1) !important;
            padding: 8px 12px !important;
            border-radius: 12px !important;
            border: 1px solid rgba(255, 193, 7, 0.3) !important;
            font-size: 0.85rem !important;
        }

        #ultima-actualizacion-dashboard i,
        #ultima-actualizacion-dashboard .text-success,
        #ultima-actualizacion-dashboard .text-danger,
        #ultima-actualizacion-dashboard .text-muted,
        #ultima-actualizacion-dashboard .fa-sync-alt,
        #ultima-actualizacion-dashboard .fa-check-circle,
        #ultima-actualizacion-dashboard .fa-exclamation-circle,
        #ultima-actualizacion-dashboard .fa-clock {
            color: #ffc107 !important;
            text-shadow: 0 1px 3px rgba(255, 193, 7, 0.5) !important;
            font-weight: 700 !important;
        }

        .card.clientes .icon-container {
            background: linear-gradient(135deg, #e0e7ff 0%, #4f8cff 100%);
            color: #1976d2;
            animation: pulse-blue 2s infinite;
        }
        .card.inventario .icon-container {
            background: linear-gradient(135deg, #e0ffe7 0%, #43aa8b 100%);
            color: #43aa8b;
            animation: pulse-green 2s infinite;
        }
        .card.facturas .icon-container {
            background: linear-gradient(135deg, #ede7ff 0%, #6C5CE7 100%);
            color: #6C5CE7;
            animation: pulse-purple 2s infinite;
        }
        @keyframes pulse-blue {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); filter: drop-shadow(0 0 8px #1976d2aa); }
            100% { transform: scale(1); }
        }
        @keyframes pulse-green {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); filter: drop-shadow(0 0 8px #43aa8baa); }
            100% { transform: scale(1); }
        }
        @keyframes pulse-purple {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); filter: drop-shadow(0 0 8px #6C5CE7aa); }
            100% { transform: scale(1); }
        }
        .card.clientes .stat-title,
        .card.inventario .stat-title,
        .card.facturas .stat-title,
        .card.clientes .stat-value,
        .card.inventario .stat-value,
        .card.facturas .stat-value {
            color: #111 !important;
            text-shadow: 0 2px 8px #fff, 0 1px 0 #fff, 0 0 2px #fff8;
            font-weight: 900;
        }
        .card.clientes .icon-container i,
        .card.inventario .icon-container i,
        .card.facturas .icon-container i {
            font-size: 2.1rem;
            transition: color 0.3s, text-shadow 0.3s, transform 0.3s;
        }
        .card.clientes:hover .icon-container,
        .card.inventario:hover .icon-container,
        .card.facturas:hover .icon-container {
            background: rgba(255,255,255,0.25);
            transform: scale(1.08) rotate(-4deg);
        }
        .card.clientes:hover .icon-container i {
            color: #1565c0;
            text-shadow: 0 2px 8px #1976d2aa, 0 1px 0 #fff;
        }
        .card.inventario:hover .icon-container i {
            color: #388e3c;
            text-shadow: 0 2px 8px #43aa8baa, 0 1px 0 #fff;
        }
        .card.facturas:hover .icon-container i {
            color: #512da8;
            text-shadow: 0 2px 8px #6C5CE7aa, 0 1px 0 #fff;
        }

        /* Efectos hover para los iconos del dashboard principal */
        .card.clientes:hover .icon-container,
        .card.inventario:hover .icon-container,
        .card.facturas:hover .icon-container,
        .card.tasa-bcv:hover .icon-container {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 6px 20px rgba(0, 255, 136, 0.5);
            transition: all 0.3s ease;
        }
        
        .card.clientes:hover .icon-container i,
        .card.inventario:hover .icon-container i,
        .card.facturas:hover .icon-container i,
        .card.tasa-bcv:hover .icon-container i {
            transform: scale(1.2);
            transition: all 0.3s ease;
        }

        /* Estilos mejorados para la tarjeta de tasa BCV */
        .tasa-bcv-container {
            padding: 10px 0;
        }
        
        .tasa-bcv-value {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .tasa-numero {
            font-size: 2.5rem !important;
            font-weight: 800 !important;
            color: #1a1a1a !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            letter-spacing: -1px;
        }
        
        .tasa-badge {
            padding: 8px 16px !important;
            border-radius: 20px !important;
            font-weight: 700 !important;
            font-size: 0.9rem !important;
            text-transform: uppercase !important;
            letter-spacing: 0.5px !important;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
        }
        
        .bcv-badge {
            background: linear-gradient(135deg, #ffc107, #ff8f00) !important;
            color: #1a1a1a !important;
        }
        
        .eur-badge {
            background: linear-gradient(135deg, #2196f3, #1976d2) !important;
            color: white !important;
        }
        
        .tasa-currency {
            font-size: 1.1rem !important;
            font-weight: 600 !important;
            color: #1a1a1a !important;
            margin-bottom: 8px;
            letter-spacing: 1px;
        }
        
        .tasa-trend {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem !important;
            color: #ffc107 !important;
            font-weight: 700 !important;
            text-shadow: 0 1px 3px rgba(255, 193, 7, 0.5);
            background: rgba(255, 193, 7, 0.1);
            padding: 6px 12px;
            border-radius: 15px;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }
        
        .tasa-trend i {
            color: #ffc107 !important;
            animation: pulse 2s infinite;
            text-shadow: 0 1px 3px rgba(255, 193, 7, 0.5);
        }
        
        .tasa-control {
            background: rgba(255, 193, 7, 0.15) !important;
            border: 2px solid rgba(255, 193, 7, 0.4) !important;
            color: #ffc107 !important;
            width: 45px !important;
            height: 45px !important;
            border-radius: 50% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            transition: all 0.3s ease !important;
            opacity: 0.8 !important;
            font-size: 1.1rem !important;
            font-weight: bold !important;
            text-shadow: 0 1px 3px rgba(255, 193, 7, 0.5);
            box-shadow: 0 2px 8px rgba(255, 193, 7, 0.2) !important;
        }
        
        .tasa-control:hover {
            background: rgba(255, 193, 7, 0.25) !important;
            border-color: rgba(255, 193, 7, 0.8) !important;
            opacity: 1 !important;
            transform: scale(1.15) !important;
            color: #ff8f00 !important;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.4) !important;
        }
        
        .btn-tasa-actualizar {
            background: linear-gradient(135deg, #00ff88, #00cc6a) !important;
            border: none !important;
            color: #1a1a1a !important;
            font-weight: 700 !important;
            padding: 10px 20px !important;
            border-radius: 25px !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3) !important;
        }
        
        .btn-tasa-actualizar:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 20px rgba(0, 255, 136, 0.4) !important;
            background: linear-gradient(135deg, #00cc6a, #00aa55) !important;
        }
        
        .btn-tasa-actualizar:disabled {
            opacity: 0.6 !important;
            transform: none !important;
            cursor: not-allowed !important;
        }

        /* Animaciones para notificaciones */
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        
        @keyframes progressBar {
            from {
                width: 100%;
            }
            to {
                width: 0%;
            }
        }
        
        .btn-close-notificacion:hover {
            background-color: rgba(255, 255, 255, 0.2) !important;
        }

        /* Estilos mejorados para la sección de servicio técnico */
        .servicio-tecnico-card {
            border: 2px solid #00ff88;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 255, 136, 0.2);
            background: linear-gradient(135deg, #ffffff 0%, #f8fffe 100%);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: card-gentle-float 8s ease-in-out infinite;
        }

        .servicio-tecnico-card:hover {
            box-shadow: 0 20px 50px rgba(0, 255, 136, 0.4), 0 0 30px rgba(0, 255, 136, 0.2);
            transform: translateY(-8px) scale(1.02);
            background: linear-gradient(135deg, #ffffff 0%, #f0fff8 100%);
        }

        .servicio-tecnico-header {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            border-radius: 14px 14px 0 0;
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }

        .servicio-tecnico-header h5 {
            color: #1a1a1a;
            font-weight: 800;
            font-size: 1.4rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 0;
        }

        .servicio-tecnico-header i {
            color: #1a1a1a;
            font-size: 1.6rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .servicio-orden-item {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 12px;
            margin-bottom: 12px;
            padding: 1.2rem;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .servicio-orden-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            transition: width 0.3s ease;
        }

        .servicio-orden-item:hover {
            transform: translateX(8px) translateY(-4px);
            box-shadow: 0 12px 28px rgba(0, 255, 136, 0.25), 0 0 20px rgba(0, 255, 136, 0.15);
            border-color: rgba(0, 255, 136, 0.6);
            background: linear-gradient(135deg, #ffffff 0%, #f0fff8 100%);
        }

        .servicio-orden-item:hover::before {
            width: 8px;
        }

        .servicio-orden-icon {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 204, 106, 0.1) 100%);
            border-radius: 50%;
            padding: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            transition: all 0.3s ease;
            border: 2px solid rgba(0, 255, 136, 0.2);
        }

        .servicio-orden-item:hover .servicio-orden-icon {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.2) 0%, rgba(0, 204, 106, 0.2) 100%);
            border-color: rgba(0, 255, 136, 0.4);
            transform: scale(1.1) rotate(5deg);
        }

        .servicio-orden-icon i {
            font-size: 1.4rem;
            transition: all 0.3s ease;
        }

        .servicio-orden-item:hover .servicio-orden-icon i {
            transform: scale(1.2);
        }

        .servicio-orden-numero {
            font-weight: 800;
            color: #1a1a1a;
            font-size: 1.1rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .servicio-orden-badge {
            font-size: 0.75rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        .servicio-orden-item:hover .servicio-orden-badge {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .servicio-orden-cliente {
            font-weight: 700;
            color: #1a1a1a;
            font-size: 1rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .servicio-orden-equipo {
            color: #6c757d;
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.3rem;
        }

        .servicio-orden-problema {
            color: #495057;
            font-size: 0.85rem;
            font-style: italic;
            background: rgba(0, 255, 136, 0.05);
            padding: 0.5rem;
            border-radius: 8px;
            border-left: 3px solid rgba(0, 255, 136, 0.3);
            margin-top: 0.5rem;
        }

        .servicio-orden-fecha {
            color: #6c757d;
            font-weight: 600;
            font-size: 0.85rem;
            text-align: right;
        }

        .servicio-orden-fecha i {
            color: #00ff88;
            margin-right: 0.3rem;
        }

        .servicio-orden-entrega {
            color: #28a745;
            font-weight: 600;
            font-size: 0.8rem;
            text-align: right;
            margin-top: 0.3rem;
        }

        .servicio-orden-entrega i {
            color: #28a745;
            margin-right: 0.3rem;
        }

        /* Animaciones específicas para servicio técnico */
        @keyframes servicio-card-float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-2px) rotate(0.5deg); }
            50% { transform: translateY(-4px) rotate(0deg); }
            75% { transform: translateY(-2px) rotate(-0.5deg); }
        }

        .servicio-tecnico-card {
            animation: servicio-card-float 10s ease-in-out infinite;
        }

        @keyframes servicio-item-glow {
            0%, 100% { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); }
            50% { box-shadow: 0 6px 16px rgba(0, 255, 136, 0.15); }
        }

        .servicio-orden-item {
            animation: servicio-item-glow 6s ease-in-out infinite;
        }

    </style>
    <div class="main-bg-blur"></div>
    <div class="container-fluid px-4">
        <div class="header-container">
            <div class="container">
                <div class="header-content">
                    <div class="row align-items-center g-3">
                        <div class="col-auto d-flex align-items-center justify-content-center" style="min-width:120px;">
                            <div class="header-logo">
                                <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo Empresa">
                            </div>
                        </div>
                        <div class="col ps-0 ps-md-3">
                            <h1 class="welcome-text mb-1">Bienvenido a {{ empresa.nombre.split(' - ')[0] if empresa and empresa.nombre else 'TECNICEL' }}</h1>
                            <p class="welcome-subtext mb-0">Panel de Control - {{ empresa.nombre if empresa and empresa.nombre else 'Sistema de Reparaciones' }}</p>
                        </div>
                        <div class="col-12 col-md-auto text-md-start mt-3 mt-md-0">
                            <div id="fecha-hora-actual"></div>
                        </div>
                    </div>
                    <div class="col-12 mt-3">
                        <div class="row g-3 justify-content-center">
                            <div class="col-md-6 col-lg-3">
                                <div class="header-stat-card cobranza d-flex flex-column align-items-start justify-content-center position-relative" id="card-cobranza">
                                    <!-- Filtro principal en esquina superior derecha -->
                                    <div class="filtro-principal position-absolute" style="top: 10px; right: 10px;">
                                        <div class="dropdown">
                                            <button class="btn btn-sm btn-outline-light filtro-btn" type="button" onclick="abrirModalFiltro('cobranza')" data-tarjeta="cobranza">
                                                <i class="fas fa-filter me-1"></i>
                                                <span class="filtro-texto">Todos</span>
                                            </button>
                                            <ul class="dropdown-menu dropdown-menu-end filtro-menu" style="transform: translateY(-100%);">
                                                <li><a class="dropdown-item filtro-opcion" href="#" data-tipo="" data-valor="">Todos</a></li>
                                                <li><a class="dropdown-item filtro-opcion" href="#" data-tipo="hoy" data-valor="">Hoy</a></li>
                                                <li><hr class="dropdown-divider"></li>
                                                <li class="px-3 py-2">
                                                    <label class="form-label mb-2" style="font-size: 0.8rem; color: #6c757d; font-weight: 600;">
                                                        <i class="fas fa-calendar me-1"></i>Seleccionar Mes
                                                    </label>
                                                    <select class="form-select form-select-sm filtro-mes" data-tarjeta="cobranza">
                                                        <option value="">Seleccionar mes...</option>
                                                        <option value="1">Enero</option>
                                                        <option value="2">Febrero</option>
                                                        <option value="3">Marzo</option>
                                                        <option value="4">Abril</option>
                                                        <option value="5">Mayo</option>
                                                        <option value="6">Junio</option>
                                                        <option value="7">Julio</option>
                                                        <option value="8">Agosto</option>
                                                        <option value="9">Septiembre</option>
                                                        <option value="10">Octubre</option>
                                                        <option value="11">Noviembre</option>
                                                        <option value="12">Diciembre</option>
                                                    </select>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="icon-container mb-2" style="width: 50px; height: 50px; background: linear-gradient(135deg, #00ff88 0%, #00e676 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);">
                                        <i class="fas fa-hand-holding-usd" style="font-size: 1.5rem; color: white;"></i>
                                    </div>
                                    <i class="fas fa-sync-alt header-stat-refresh" id="refresh-cobranza" title="Actualizando datos..."></i>
                                    <div class="header-stat-label">Cuentas por Cobrar</div>
                                    <div class="header-stat-value" id="valor-cobranza">${{ total_cobrar_usd|float|es_number }}</div>
                                    <div class="header-stat-bs" id="valor-cobranza-bs">{{ total_cobrar_bs|float|es_number }} Bs</div>
                                    <div class="growth-metric mt-2">
                                        <span class="growth-indicator positive">
                                            <i class="fas fa-arrow-up"></i> +12%
                                        </span>
                                        <span class="growth-text">vs mes anterior</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3">
                                <div class="header-stat-card pagos d-flex flex-column align-items-start justify-content-center position-relative" id="card-pagos">
                                    <!-- Filtro principal en esquina superior derecha -->
                                    <div class="filtro-principal position-absolute" style="top: 10px; right: 10px;">
                                        <div class="dropdown">
                                            <button class="btn btn-sm btn-outline-light filtro-btn" type="button" onclick="abrirModalFiltro('pagos')" data-tarjeta="pagos">
                                                <i class="fas fa-filter me-1"></i>
                                                <span class="filtro-texto">Todos</span>
                                            </button>
                                            <ul class="dropdown-menu dropdown-menu-end filtro-menu" style="transform: translateY(-100%);">
                                                <li><a class="dropdown-item filtro-opcion" href="#" data-tipo="" data-valor="">Todos</a></li>
                                                <li><a class="dropdown-item filtro-opcion" href="#" data-tipo="hoy" data-valor="">Hoy</a></li>
                                                <li><hr class="dropdown-divider"></li>
                                                <li class="px-3 py-2">
                                                    <label class="form-label mb-2" style="font-size: 0.8rem; color: #6c757d; font-weight: 600;">
                                                        <i class="fas fa-calendar me-1"></i>Seleccionar Mes
                                                    </label>
                                                    <select class="form-select form-select-sm filtro-mes" data-tarjeta="pagos">
                                                        <option value="">Seleccionar mes...</option>
                                                        <option value="1">Enero</option>
                                                        <option value="2">Febrero</option>
                                                        <option value="3">Marzo</option>
                                                        <option value="4">Abril</option>
                                                        <option value="5">Mayo</option>
                                                        <option value="6">Junio</option>
                                                        <option value="7">Julio</option>
                                                        <option value="8">Agosto</option>
                                                        <option value="9">Septiembre</option>
                                                        <option value="10">Octubre</option>
                                                        <option value="11">Noviembre</option>
                                                        <option value="12">Diciembre</option>
                                                    </select>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="icon-container mb-2" style="width: 50px; height: 50px; background: linear-gradient(135deg, #00ff88 0%, #00e676 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);">
                                        <i class="fas fa-money-check-alt" style="font-size: 1.5rem; color: white;"></i>
                                    </div>
                                    <i class="fas fa-sync-alt header-stat-refresh" id="refresh-pagos" title="Actualizando datos..."></i>
                                    <div class="header-stat-label">Pagos Recibidos</div>
                                    <div class="header-stat-value" id="valor-pagos">${{ total_pagos_recibidos_usd|float|es_number }}</div>
                                    <div class="header-stat-bs" id="valor-pagos-bs">{{ total_pagos_recibidos_bs|float|es_number }} Bs</div>
                                    <div class="growth-metric mt-2">
                                        <span class="growth-indicator positive">
                                            <i class="fas fa-arrow-up"></i> +8%
                                        </span>
                                        <span class="growth-text">vs mes anterior</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3">
                                <div class="header-stat-card facturado d-flex flex-column align-items-start justify-content-center position-relative" id="card-facturado">
                                    <!-- Filtro principal en esquina superior derecha -->
                                    <div class="filtro-principal position-absolute" style="top: 10px; right: 10px;">
                                        <div class="dropdown">
                                            <button class="btn btn-sm btn-outline-light filtro-btn" type="button" onclick="abrirModalFiltro('facturado')" data-tarjeta="facturado">
                                                <i class="fas fa-filter me-1"></i>
                                                <span class="filtro-texto">Todos</span>
                                            </button>
                                            <ul class="dropdown-menu dropdown-menu-end filtro-menu" style="transform: translateY(-100%);">
                                                <li><a class="dropdown-item filtro-opcion" href="#" data-tipo="" data-valor="">Todos</a></li>
                                                <li><a class="dropdown-item filtro-opcion" href="#" data-tipo="hoy" data-valor="">Hoy</a></li>
                                                <li><hr class="dropdown-divider"></li>
                                                <li class="px-3 py-2">
                                                    <label class="form-label mb-2" style="font-size: 0.8rem; color: #6c757d; font-weight: 600;">
                                                        <i class="fas fa-calendar me-1"></i>Seleccionar Mes
                                                    </label>
                                                    <select class="form-select form-select-sm filtro-mes" data-tarjeta="facturado">
                                                        <option value="">Seleccionar mes...</option>
                                                        <option value="1">Enero</option>
                                                        <option value="2">Febrero</option>
                                                        <option value="3">Marzo</option>
                                                        <option value="4">Abril</option>
                                                        <option value="5">Mayo</option>
                                                        <option value="6">Junio</option>
                                                        <option value="7">Julio</option>
                                                        <option value="8">Agosto</option>
                                                        <option value="9">Septiembre</option>
                                                        <option value="10">Octubre</option>
                                                        <option value="11">Noviembre</option>
                                                        <option value="12">Diciembre</option>
                                                    </select>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="icon-container mb-2" style="width: 50px; height: 50px; background: linear-gradient(135deg, #00ff88 0%, #00e676 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);">
                                        <i class="fas fa-file-invoice-dollar" style="font-size: 1.5rem; color: white;"></i>
                                    </div>
                                    <div class="header-stat-label">Nota de Entrega</div>
                                    <div class="header-stat-value" id="valor-facturado">${{ total_facturado_usd|float|es_number }}</div>
                                    <div class="header-stat-bs" id="valor-facturado-bs">{{ (total_facturado_usd * tasa_bcv)|float|es_number }} Bs</div>
                                    <div class="growth-metric mt-2">
                                        <span class="growth-indicator positive">
                                            <i class="fas fa-arrow-up"></i> +15%
                                        </span>
                                        <span class="growth-text">vs mes anterior</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row g-4 main-stats">
            <div class="main-stats-carousel w-100">
                <div class="card clientes">
                    <div class="card-body text-center">
                        <div class="icon-container clientes">
                            <i class="fas fa-user-friends"></i>
                        </div>
                        <div class="stat-title">Total Clientes</div>
                        <div class="stat-value">{{ total_clientes }}</div>
                        <div class="growth-metric mt-2">
                            <span class="growth-indicator positive">
                                <i class="fas fa-arrow-up"></i> +5%
                            </span>
                            <span class="growth-text">vs mes anterior</span>
                        </div>
                    </div>
                </div>
                <div class="card inventario">
                    <div class="card-body text-center">
                        <div class="icon-container inventario">
                            <i class="fas fa-warehouse"></i>
                        </div>
                        <div class="stat-title">Productos en Inventario</div>
                        <div class="stat-value">{{ total_productos }}</div>
                        <div class="growth-metric mt-2">
                            <span class="growth-indicator positive">
                                <i class="fas fa-arrow-up"></i> +3%
                            </span>
                            <span class="growth-text">vs mes anterior</span>
                        </div>
                    </div>
                </div>
                <div class="card facturas">
                    <div class="card-body text-center">
                        <div class="icon-container facturas">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="stat-title">Notas del Mes</div>
                        <div class="stat-value">{{ notas_mes }}</div>
                        <div class="growth-metric mt-2">
                            <span class="growth-indicator positive">
                                <i class="fas fa-arrow-up"></i> +18%
                            </span>
                            <span class="growth-text">vs mes anterior</span>
                        </div>
                    </div>
                </div>
                <div class="card tasa-bcv">
                    <div class="card-body text-center">
                        <div class="icon-container tasa-bcv">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div id="tasasCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
                          <div class="carousel-inner">
                            <div class="carousel-item active">
                              <div class="tasa-bcv-container">
                                <div class="tasa-bcv-value">
                                  <span id="tasa-bcv-valor" class="tasa-numero">{{ tasa_bcv|default('Cargando...', true)|es_number }}</span>
                                  <span class="tasa-badge bcv-badge">BCV</span>
                                </div>
                                <div class="tasa-currency">Bs/USD</div>
                                <div class="tasa-trend">
                                  <i class="fas fa-chart-line"></i>
                                  <span>Tendencia</span>
                                </div>
                              </div>
                            </div>
                            <div class="carousel-item">
                              <div class="tasa-bcv-container">
                                <div class="tasa-bcv-value">
                                  <span id="tasa-eur-valor" class="tasa-numero">{{ tasa_bcv_eur|default('Cargando...', true)|es_number }}</span>
                                  <span class="tasa-badge eur-badge">EUR</span>
                                </div>
                                <div class="tasa-currency">Bs/EUR</div>
                                <div class="tasa-trend">
                                  <i class="fas fa-chart-line"></i>
                                  <span>Tendencia</span>
                                </div>
                              </div>
                            </div>
                          </div>
                          <button class="carousel-control-prev tasa-control" type="button" data-bs-target="#tasasCarousel" data-bs-slide="prev">
                            <i class="fas fa-chevron-left"></i>
                            <span class="visually-hidden">Anterior</span>
                          </button>
                          <button class="carousel-control-next tasa-control" type="button" data-bs-target="#tasasCarousel" data-bs-slide="next">
                            <i class="fas fa-chevron-right"></i>
                            <span class="visually-hidden">Siguiente</span>
                          </button>
                        </div>
                        <div class="growth-metric mt-2">
                            <span class="growth-indicator positive">
                                <i class="fas fa-arrow-up"></i> +2.5%
                            </span>
                            <span class="growth-text">vs mes anterior</span>
                        </div>
                        <small class="d-block text-muted" style="font-size:0.8rem;" id="ultima-actualizacion-dashboard">
                            <i class="fas fa-sync-alt fa-spin"></i> Actualizando...
                        </small>
                        <button class="btn btn-sm btn-tasa-actualizar mt-3" onclick="forzarActualizacionTasaBCV()" id="btn-actualizar-tasa">
                            <i class="fas fa-sync-alt"></i> Actualizar Tasa BCV
                        </button>
                    </div>
                </div>
            </div>
        </div>

    <!-- Quick Actions -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Acciones Rápidas</h5>
                </div>
                <div class="card-body">
                        <div class="row g-3">
                            <div class="col-12 col-sm-6 col-md-3">
                            <a href="/clientes/nuevo" class="btn btn-primary w-100">
                                    <i class="fas fa-user-plus"></i>Nuevo Cliente
                            </a>
                        </div>
                            <div class="col-12 col-sm-6 col-md-3">
                            <a href="/inventario/nuevo" class="btn btn-success w-100">
                                    <i class="fas fa-plus-circle"></i>Nuevo Producto
                            </a>
                        </div>
                            <!-- Módulo de Notas de Entrega eliminado -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Activity -->
        <div class="row mt-4 g-4">
            <div class="col-12 col-lg-6">
                <div class="card h-100">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="fas fa-file-invoice-dollar me-2"></i>Últimas Notas de Entrega
                        </h5>
                        <div class="dropdown">
                            <button class="btn btn-sm btn-outline-light dropdown-toggle" type="button" id="notasFilterDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-filter"></i> Filtrar
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="notasFilterDropdown">
                                <li><a class="dropdown-item" href="#" onclick="filtrarNotas('todas')"><i class="fas fa-list me-2"></i>Todas</a></li>
                                <li><a class="dropdown-item" href="#" onclick="filtrarNotas('pagadas')"><i class="fas fa-check-circle me-2"></i>Pagadas</a></li>
                                <li><a class="dropdown-item" href="#" onclick="filtrarNotas('pendientes')"><i class="fas fa-clock me-2"></i>Pendientes</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" onclick="filtrarNotas('hoy')"><i class="fas fa-calendar-day me-2"></i>Hoy</a></li>
                                <li><a class="dropdown-item" href="#" onclick="filtrarNotas('semana')"><i class="fas fa-calendar-week me-2"></i>Esta Semana</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="list-group list-group-flush" id="notas-list">
                            {% for nota in ultimas_notas %}
                            <a href="{{ url_for('editar_nota_entrega', id=nota.id) }}" class="list-group-item list-group-item-action factura-item" data-estado="{{ nota.estado|lower }}" data-fecha="{{ nota.fecha }}">
                                <div class="d-flex w-100 justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <div class="me-3">
                                            {% if nota.estado|lower == 'pagada' %}
                                                <i class="fas fa-check-circle text-success"></i>
                                            {% elif nota.estado|lower == 'pendiente' %}
                                                <i class="fas fa-clock text-warning"></i>
                                            {% else %}
                                                <i class="fas fa-file-invoice text-primary"></i>
                                            {% endif %}
                                        </div>
                                        <div>
                                            <h6 class="mb-1 fw-bold text-dark">#{{ nota.numero }}</h6>
                                            <small class="text-dark fw-semibold">{{ nota.cliente }}</small>
                                        </div>
                                    </div>
                                    <div class="text-end">
                                        <div class="fw-bold text-dark">${{ nota.total }}</div>
                                        <small class="text-dark fw-semibold">{{ nota.fecha }}</small>
                                    </div>
                                </div>
                            </a>
                            {% endfor %}
                        </div>
                        <div class="card-footer text-center">
                            <!-- Módulo de Notas de Entrega eliminado -->
                                <i class="fas fa-eye me-1"></i>Ver Todas las Notas de Entrega
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-lg-6">
                <div class="row g-3">
                    <div class="col-12">
                        <div class="card h-100">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-exclamation-triangle me-2"></i>Productos con Bajo Stock
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="list-group">
                                    {% for producto in productos_bajo_stock %}
                                    <a href="{{ url_for('ver_producto', id=producto.id if producto.id is defined else loop.index) }}" class="list-group-item list-group-item-action">
                                        <div class="d-flex w-100 justify-content-between align-items-center">
                                            <div class="d-flex align-items-center">
                                                <div class="me-3">
                                                    <i class="fas fa-exclamation-triangle text-warning"></i>
                                                </div>
                                                <div>
                                                    <h6 class="mb-1 fw-bold text-dark">{{ producto.nombre }}</h6>
                                                    <small class="text-dark fw-semibold">{{ producto.categoria }}</small>
                                                </div>
                                            </div>
                                            <div class="text-end">
                                                <span class="badge bg-danger">{{ producto.stock or producto.cantidad }}</span>
                                            </div>
                                        </div>
                                    </a>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-12">
                        <div class="card h-100 servicio-tecnico-card">
                            <div class="card-header servicio-tecnico-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-tools me-2"></i>Órdenes Pendientes
                                </h5>
                            </div>
                            <div class="card-body p-4">
                                <div class="list-group list-group-flush">
                                    {% for orden in ordenes_pendientes %}
                                    <a href="{{ url_for('ver_orden_servicio', id=orden.id) }}" class="list-group-item list-group-item-action servicio-orden-item border-0 p-0 mb-3">
                                        <div class="d-flex w-100 justify-content-between align-items-start">
                                            <div class="d-flex align-items-start">
                                                <div class="servicio-orden-icon me-3">
                                                    {% if orden.estado == 'pendiente' %}
                                                        <i class="fas fa-clock text-warning"></i>
                                                    {% elif orden.estado == 'en_espera_revision' %}
                                                        <i class="fas fa-hourglass-half text-warning"></i>
                                                    {% elif orden.estado == 'en_proceso' %}
                                                        <i class="fas fa-cog text-primary"></i>
                                                    {% elif orden.estado == 'diagnostico' %}
                                                        <i class="fas fa-search text-info"></i>
                                                    {% else %}
                                                        <i class="fas fa-tools text-secondary"></i>
                                                    {% endif %}
                                                </div>
                                                <div class="flex-grow-1">
                                                    <div class="d-flex align-items-center mb-2">
                                                        <h6 class="servicio-orden-numero me-3">#{{ orden.numero_orden or orden.id }}</h6>
                                                        {% if orden.estado == 'pendiente' %}
                                                            <span class="badge bg-warning text-dark servicio-orden-badge">Pendiente</span>
                                                        {% elif orden.estado == 'en_espera_revision' %}
                                                            <span class="badge bg-warning text-dark servicio-orden-badge">En Espera de Revisión</span>
                                                        {% elif orden.estado == 'en_proceso' %}
                                                            <span class="badge bg-primary servicio-orden-badge">En Proceso</span>
                                                        {% elif orden.estado == 'diagnostico' %}
                                                            <span class="badge bg-info servicio-orden-badge">Diagnóstico</span>
                                                        {% else %}
                                                            <span class="badge bg-secondary servicio-orden-badge">{{ orden.estado|title }}</span>
                                                        {% endif %}
                                                    </div>
                                                    <div class="servicio-orden-cliente">
                                                        <i class="fas fa-user me-2"></i>{{ orden.cliente }}
                                                    </div>
                                                    {% if orden.equipo and orden.equipo.marca %}
                                                    <div class="servicio-orden-equipo">
                                                        <i class="fas fa-mobile-alt me-2"></i>{{ orden.equipo.marca }} {{ orden.equipo.modelo or '' }}
                                                    </div>
                                                    {% endif %}
                                                    {% if orden.problema_reportado %}
                                                    <div class="servicio-orden-problema">
                                                        <i class="fas fa-exclamation-circle me-2"></i>{{ orden.problema_reportado[:50] }}{% if orden.problema_reportado|length > 50 %}...{% endif %}
                                                    </div>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="text-end">
                                                <div class="servicio-orden-fecha">
                                                    <i class="fas fa-calendar"></i>{{ orden.fecha_recepcion or orden.fecha_creacion }}
                                                </div>
                                                {% if orden.fecha_entrega_estimada %}
                                                <div class="servicio-orden-entrega">
                                                    <i class="fas fa-clock"></i>Entrega: {{ orden.fecha_entrega_estimada }}
                                                </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </a>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% if advertencia_tasa %}
    <div class="alert alert-warning mt-3" role="alert">
        <i class="fas fa-exclamation-circle me-2"></i>{{ advertencia_tasa }}
    </div>
    {% endif %}
    {% endblock %}

    {% block extra_js %}
    <script>
    function actualizarFechaHora() {
        const now = new Date();
        // Fecha: miércoles, 21 de mayo de 2025
        const fecha = now.toLocaleDateString('es-VE', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // Hora manual en 12 horas, con AM/PM en español
        let horas = now.getHours();
        const minutos = now.getMinutes().toString().padStart(2, '0');
        const segundos = now.getSeconds().toString().padStart(2, '0');
        const ampm = horas >= 12 ? 'p. m.' : 'a. m.';
        horas = horas % 12;
        horas = horas ? horas : 12; // el 0 se muestra como 12

        const hora = `${horas.toString().padStart(2, '0')}:${minutos}:${segundos} ${ampm}`;

        document.getElementById('fecha-hora-actual').textContent = `${fecha}, ${hora}`;
    }
    actualizarFechaHora();
    setInterval(actualizarFechaHora, 1000);

    // Función para filtrar pagos recibidos
    function filtrarPagos(periodo) {
        const pagosValue = document.getElementById('pagos-value');
        const pagosBs = document.getElementById('pagos-bs');
        const pagosPeriodo = document.getElementById('pagos-periodo');
        
        // Mostrar indicador de carga
        pagosValue.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Cargando...';
        pagosBs.innerHTML = '';
        pagosPeriodo.innerHTML = 'Cargando datos...';
        
        console.log(`Filtrando pagos para período: ${periodo}`);
        
        // Llamada a la API
        fetch(`/api/pagos-filtrados?periodo=${periodo}`)
            .then(response => {
                console.log('Response status:', response.status);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('API Response:', data);
                if (data.success) {
                    pagosValue.textContent = `$${data.total_usd}`;
                    pagosBs.textContent = `${data.total_bs} Bs`;
                    
                    // Actualizar el texto del período
                    switch(periodo) {
                        case 'hoy':
                            pagosPeriodo.textContent = 'Hoy';
                            break;
                        case 'semana':
                            pagosPeriodo.textContent = 'Esta semana';
                            break;
                        case 'mes':
                            pagosPeriodo.textContent = 'Este mes';
                            break;
                        case 'todos':
                            pagosPeriodo.textContent = 'Todos los períodos';
                            break;
                    }
                } else {
                    // En caso de error, mostrar datos por defecto
                    pagosValue.textContent = '$0,00';
                    pagosBs.textContent = '0,00 Bs';
                    pagosPeriodo.textContent = `Error: ${data.error || 'Desconocido'}`;
                    console.error('API Error:', data.error);
                }
            })
            .catch(error => {
                console.error('Error al filtrar pagos:', error);
                // En caso de error, mostrar datos por defecto
                pagosValue.textContent = '$0,00';
                pagosBs.textContent = '0,00 Bs';
                pagosPeriodo.textContent = `Error de conexión: ${error.message}`;
            });
    }

    // Función para filtrar cuentas por cobrar
    function filtrarCobranza(periodo) {
        const cobranzaValue = document.getElementById('cobranza-value');
        const cobranzaBs = document.getElementById('cobranza-bs');
        const cobranzaPeriodo = document.getElementById('cobranza-periodo');
        
        // Mostrar indicador de carga
        cobranzaValue.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Cargando...';
        cobranzaBs.innerHTML = '';
        cobranzaPeriodo.innerHTML = 'Cargando datos...';
        
        console.log(`Filtrando cobranza para período: ${periodo}`);
        
        // Llamada a la API
        fetch(`/api/cobranza-filtrada?periodo=${periodo}`)
            .then(response => {
                console.log('Response status:', response.status);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('API Response:', data);
                if (data.success) {
                    cobranzaValue.textContent = `$${data.total_usd}`;
                    cobranzaBs.textContent = `${data.total_bs} Bs`;
                    
                    // Actualizar el texto del período
                    switch(periodo) {
                        case 'hoy':
                            cobranzaPeriodo.textContent = 'Hoy';
                            break;
                        case 'semana':
                            cobranzaPeriodo.textContent = 'Esta semana';
                            break;
                        case 'mes':
                            cobranzaPeriodo.textContent = 'Este mes';
                            break;
                        case 'todos':
                            cobranzaPeriodo.textContent = 'Todos los períodos';
                            break;
                    }
                } else {
                    // En caso de error, mostrar datos por defecto
                    cobranzaValue.textContent = '$0,00';
                    cobranzaBs.textContent = '0,00 Bs';
                    cobranzaPeriodo.textContent = `Error: ${data.error || 'Desconocido'}`;
                    console.error('API Error:', data.error);
                }
            })
            .catch(error => {
                console.error('Error al filtrar cobranza:', error);
                // En caso de error, mostrar datos por defecto
                cobranzaValue.textContent = '$0,00';
                cobranzaBs.textContent = '0,00 Bs';
                cobranzaPeriodo.textContent = `Error de conexión: ${error.message}`;
            });
    }

    // Función para filtrar facturado
    function filtrarNotaEntrega(periodo) {
        const facturadoValue = document.getElementById('facturado-value');
        const facturadoBs = document.getElementById('facturado-bs');
        const facturadoPeriodo = document.getElementById('facturado-periodo');
        
        // Mostrar indicador de carga
        facturadoValue.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Cargando...';
        facturadoBs.innerHTML = '';
        facturadoPeriodo.innerHTML = 'Cargando datos...';
        
        console.log(`Filtrando facturado para período: ${periodo}`);
        
        // Llamada a la API
        fetch(`/api/facturado-filtrado?periodo=${periodo}`)
            .then(response => {
                console.log('Response status:', response.status);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('API Response:', data);
                if (data.success) {
                    facturadoValue.textContent = `$${data.total_usd}`;
                    facturadoBs.textContent = 'Total USD';
                    
                    // Actualizar el texto del período
                    switch(periodo) {
                        case 'hoy':
                            facturadoPeriodo.textContent = 'Hoy';
                            break;
                        case 'semana':
                            facturadoPeriodo.textContent = 'Esta semana';
                            break;
                        case 'mes':
                            facturadoPeriodo.textContent = 'Este mes';
                            break;
                        case 'todos':
                            facturadoPeriodo.textContent = 'Todos los períodos';
                            break;
                    }
                } else {
                    // En caso de error, mostrar datos por defecto
                    facturadoValue.textContent = '$0,00';
                    facturadoBs.textContent = 'Total USD';
                    facturadoPeriodo.textContent = `Error: ${data.error || 'Desconocido'}`;
                    console.error('API Error:', data.error);
                }
            })
            .catch(error => {
                console.error('Error al filtrar facturado:', error);
                // En caso de error, mostrar datos por defecto
                facturadoValue.textContent = '$0,00';
                facturadoBs.textContent = 'Total USD';
                facturadoPeriodo.textContent = `Error de conexión: ${error.message}`;
            });
    }

    // Función para filtrar notas
    function filtrarNotas(filtro) {
        const notas = document.querySelectorAll('.factura-item');
        const hoy = new Date().toISOString().split('T')[0];
        const inicioSemana = new Date();
        inicioSemana.setDate(inicioSemana.getDate() - inicioSemana.getDay());
        const inicioSemanaStr = inicioSemana.toISOString().split('T')[0];
        
        notas.forEach(nota => {
            const estado = nota.getAttribute('data-estado');
            const fecha = nota.getAttribute('data-fecha');
            let mostrar = true;
            
            switch(filtro) {
                case 'todas':
                    mostrar = true;
                    break;
                case 'pagadas':
                    mostrar = estado === 'pagada';
                    break;
                case 'pendientes':
                    mostrar = estado === 'pendiente';
                    break;
                case 'hoy':
                    mostrar = fecha === hoy;
                    break;
                case 'semana':
                    mostrar = fecha >= inicioSemanaStr && fecha <= hoy;
                    break;
                default:
                    mostrar = true;
            }
            
            if (mostrar) {
                nota.style.display = 'block';
                nota.style.animation = 'fadeIn 0.3s ease-in';
            } else {
                nota.style.display = 'none';
            }
        });
        
        // Actualizar el texto del botón de filtro
        const filterButton = document.querySelector('#notasFilterDropdown');
        const filterText = filterButton.querySelector('i').nextSibling;
        const filterTexts = {
            'todas': 'Todas',
            'pagadas': 'Pagadas',
            'pendientes': 'Pendientes',
            'hoy': 'Hoy',
            'semana': 'Esta Semana'
        };
        filterText.textContent = ` ${filterTexts[filtro] || 'Filtrar'}`;
    }


    // Función para actualizar pagos (mantener funcionalidad existente)
    function actualizarPagos() {
        const refreshIcon = document.getElementById('refresh-pagos');
        if (refreshIcon) {
            refreshIcon.classList.add('fa-spin');
            refreshIcon.title = 'Actualizando datos...';
        }
        
        // Aquí puedes agregar la lógica para actualizar los datos
        setTimeout(() => {
            if (refreshIcon) {
                refreshIcon.classList.remove('fa-spin');
                refreshIcon.title = 'Actualizar datos';
            }
        }, 2000);
    }
    </script>

    <script>
    function actualizarTasasDashboard() {
        const ultimaActualizacion = document.getElementById('ultima-actualizacion-dashboard');
        if (ultimaActualizacion) {
            ultimaActualizacion.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> Actualizando...';
        }
        fetch('/api/tasas-actualizadas')
            .then(r => r.json())
            .then(data => {
                if (!data || typeof data !== 'object') return;
                const tasa_bcv = parseFloat(data.tasa_bcv);
                const tasa_bcv_eur = parseFloat(data.tasa_bcv_eur);
                if (!isNaN(tasa_bcv)) {
                    const el = document.getElementById('tasa-bcv-valor');
                    if (el) el.textContent = tasa_bcv.toLocaleString('es-ES', {minimumFractionDigits:2, maximumFractionDigits:2});
                }
                if (!isNaN(tasa_bcv_eur)) {
                    const el = document.getElementById('tasa-eur-valor');
                    if (el) el.textContent = tasa_bcv_eur.toLocaleString('es-ES', {minimumFractionDigits:2, maximumFractionDigits:2});
                }
                if (ultimaActualizacion) {
                    const fecha = data.fecha_actualizacion ? new Date(data.fecha_actualizacion).toLocaleString() : '';
                    ultimaActualizacion.innerHTML = `<i class='fas fa-check-circle text-success'></i> Actualizado: ${fecha}`;
                    setTimeout(() => {
                        ultimaActualizacion.innerHTML = `<i class='fas fa-clock text-muted'></i> Última actualización: ${fecha}`;
                    }, 3000);
                }
            })
            .catch(error => {
                if (ultimaActualizacion) {
                    ultimaActualizacion.innerHTML = `<i class='fas fa-exclamation-circle text-danger'></i> Error: ${error.message}`;
                }
            });
    }
    document.addEventListener('DOMContentLoaded', function() {
        actualizarTasasDashboard();
        setInterval(actualizarTasasDashboard, 5 * 60 * 1000);
    });
    </script>

    <script>
    // Animar la rueda de actualización cada 3 minutos
    function spinHeaderRefresh() {
        document.getElementById('refresh-cobranza').classList.add('spin');
        document.getElementById('refresh-pagos').classList.add('spin');
        setTimeout(() => {
            document.getElementById('refresh-cobranza').classList.remove('spin');
            document.getElementById('refresh-pagos').classList.remove('spin');
        }, 1800);
    }
    setInterval(spinHeaderRefresh, 3 * 60 * 1000);
    // Animación inicial al cargar
    spinHeaderRefresh();
    </script>

    <script>
    // Función para forzar la actualización de la tasa BCV
    function forzarActualizacionTasaBCV() {
        const btn = document.getElementById('btn-actualizar-tasa');
        const ultimaActualizacion = document.getElementById('ultima-actualizacion-dashboard');
        
        // Deshabilitar botón y mostrar estado
        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Actualizando...';
        ultimaActualizacion.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> Forzando actualización...';
        
        // Llamar a la API de forzar actualización
        fetch('/forzar-actualizacion-tasa-bcv')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Actualizar el valor mostrado
                    const tasaElement = document.getElementById('tasa-bcv-valor');
                    if (tasaElement) {
                        tasaElement.textContent = data.tasa_nueva.toLocaleString('es-ES', {
                            minimumFractionDigits: 2,
                            maximumFractionDigits: 2
                        });
                    }
                    
                    // Mostrar mensaje de éxito
                    ultimaActualizacion.innerHTML = `<i class="fas fa-check-circle text-success"></i> ¡Tasa actualizada! ${data.tasa_nueva}`;
                    
                    // Mostrar notificación
                    mostrarNotificacion('success', 'Tasa BCV Actualizada', `Nueva tasa: ${data.tasa_nueva} Bs/USD`);
                    
                    // Recargar tasas del dashboard después de 2 segundos
                    setTimeout(() => {
                        actualizarTasasDashboard();
                    }, 2000);
                } else {
                    ultimaActualizacion.innerHTML = `<i class="fas fa-exclamation-circle text-danger"></i> Error: ${data.message}`;
                    mostrarNotificacion('error', 'Error al Actualizar', data.message);
                }
            })
            .catch(error => {
                ultimaActualizacion.innerHTML = `<i class="fas fa-exclamation-circle text-danger"></i> Error de conexión`;
                mostrarNotificacion('error', 'Error de Conexión', 'No se pudo conectar con el servidor');
                console.error('Error:', error);
            })
            .finally(() => {
                // Restaurar botón
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-sync-alt"></i> Actualizar Tasa BCV';
            });
    }
    
    // Función para mostrar notificaciones mejoradas
    function mostrarNotificacion(tipo, titulo, mensaje) {
        // Crear notificación personalizada
        const notificacionDiv = document.createElement('div');
        notificacionDiv.className = `notificacion-tasa ${tipo === 'success' ? 'notificacion-success' : 'notificacion-error'}`;
        notificacionDiv.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            min-width: 350px;
            max-width: 400px;
            padding: 0;
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: slideInRight 0.5s ease-out, pulse 2s infinite;
            overflow: hidden;
        `;
        
        const icono = tipo === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-triangle';
        const colorFondo = tipo === 'success' ? 'linear-gradient(135deg, #00ff88, #00cc6a)' : 'linear-gradient(135deg, #ff6b6b, #ee5a52)';
        
        notificacionDiv.innerHTML = `
            <div class="notificacion-header" style="
                background: ${colorFondo};
                padding: 15px 20px;
                color: white;
                font-weight: bold;
                display: flex;
                align-items: center;
                justify-content: space-between;
            ">
                <div style="display: flex; align-items: center;">
                    <i class="${icono}" style="font-size: 1.2rem; margin-right: 10px;"></i>
                    <span>${titulo}</span>
                </div>
                <button type="button" class="btn-close-notificacion" style="
                    background: none;
                    border: none;
                    color: white;
                    font-size: 1.2rem;
                    cursor: pointer;
                    padding: 0;
                    width: 25px;
                    height: 25px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    border-radius: 50%;
                    transition: background-color 0.3s ease;
                ">&times;</button>
            </div>
            <div class="notificacion-body" style="
                background: white;
                padding: 20px;
                color: #333;
                font-size: 0.95rem;
                line-height: 1.4;
            ">
                ${mensaje}
            </div>
            <div class="notificacion-progress" style="
                height: 4px;
                background: ${tipo === 'success' ? '#00ff88' : '#ff6b6b'};
                animation: progressBar 5s linear forwards;
            "></div>
        `;
        
        document.body.appendChild(notificacionDiv);
        
        // Agregar evento de cierre
        const btnCerrar = notificacionDiv.querySelector('.btn-close-notificacion');
        btnCerrar.addEventListener('click', () => {
            notificacionDiv.style.animation = 'slideOutRight 0.3s ease-in forwards';
            setTimeout(() => {
                if (notificacionDiv.parentNode) {
                    notificacionDiv.remove();
                }
            }, 300);
        });
        
        // Auto-remover después de 5 segundos
        setTimeout(() => {
            if (notificacionDiv.parentNode) {
                notificacionDiv.style.animation = 'slideOutRight 0.3s ease-in forwards';
                setTimeout(() => {
                    if (notificacionDiv.parentNode) {
                        notificacionDiv.remove();
                    }
                }, 300);
            }
        }, 5000);
    }
    </script>

    <!-- JavaScript para filtros simplificados -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('🚀 Inicializando sistema de filtros...');
        
        // Esperar un poco para asegurar que el DOM esté completamente cargado
        setTimeout(() => {
            inicializarFiltros();
        }, 100);
        
        function inicializarFiltros() {
            const filtrosMes = document.querySelectorAll('.filtro-mes');
            const opcionesFiltro = document.querySelectorAll('.filtro-opcion');
            
            console.log(`📊 Encontrados: ${filtrosMes.length} filtros de mes, ${opcionesFiltro.length} opciones`);
            
            // Manejar selector de mes
            filtrosMes.forEach((select, index) => {
                select.addEventListener('change', function() {
                    const tarjeta = this.dataset.tarjeta;
                    const mes = this.value;
                    
                    console.log(`📆 Filtro de mes activado para ${tarjeta}: ${mes}`);
                    
                    if (mes) {
                        const nombreMes = obtenerNombreMes(parseInt(mes));
                        actualizarFiltro(tarjeta, 'mes_especifico', mes, nombreMes);
                    }
                });
            });
            
            // Manejar opciones de filtro (Todos, Hoy)
            opcionesFiltro.forEach(opcion => {
                opcion.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tarjeta = this.closest('.filtro-principal').querySelector('.filtro-btn').dataset.tarjeta;
                    const tipo = this.dataset.tipo;
                    const valor = this.dataset.valor;
                    const texto = this.textContent.trim();
                    
                    console.log(`🔍 Opción de filtro activada para ${tarjeta}: ${tipo} - ${texto}`);
                    
                    if (tipo) {
                        actualizarFiltro(tarjeta, tipo, valor, texto);
                    } else {
                        restaurarFiltro(tarjeta);
                    }
                });
            });
        }
        
        function actualizarFiltro(tarjeta, tipo, valor, textoMostrar) {
            try {
                // Obtener elementos del filtro
                const botonFiltro = document.querySelector(`[data-tarjeta="${tarjeta}"] .filtro-texto`);
                const botonCompleto = document.querySelector(`[data-tarjeta="${tarjeta}"]`);
                
                if (botonFiltro) {
                    // Actualizar texto del botón
                    botonFiltro.textContent = textoMostrar;
                    console.log(`✅ Texto del botón actualizado: ${textoMostrar}`);
                    
                    // Agregar indicador visual de filtro activo
                    if (botonCompleto) {
                        botonCompleto.classList.add('filtro-activo', 'filtro-pulsando');
                        
                        // Remover animación después de completarse
                        setTimeout(() => {
                            botonCompleto.classList.remove('filtro-pulsando');
                        }, 600);
                    }
                }
                
                // Aplicar filtro
                actualizarTarjetaIndividual(tarjeta, tipo, valor);
                
                // Cerrar dropdown
                cerrarDropdown(tarjeta);
                
            } catch (error) {
                console.error('❌ Error actualizando filtro:', error);
                mostrarNotificacion('error', 'Error de Filtro', 'No se pudo aplicar el filtro seleccionado');
            }
        }
        
        function restaurarFiltro(tarjeta) {
            try {
                // Obtener elementos del filtro
                const botonFiltro = document.querySelector(`[data-tarjeta="${tarjeta}"] .filtro-texto`);
                const botonCompleto = document.querySelector(`[data-tarjeta="${tarjeta}"]`);
                
                if (botonFiltro) {
                    // Restaurar texto del botón
                    botonFiltro.textContent = 'Todos';
                    
                    // Remover indicador visual de filtro activo
                    if (botonCompleto) {
                        botonCompleto.classList.remove('filtro-activo');
                    }
                }
                
                // Limpiar selector de mes
                const filtroMes = document.querySelector(`[data-tarjeta="${tarjeta}"].filtro-mes`);
                if (filtroMes) filtroMes.value = '';
                
                // Restaurar valores originales
                restaurarValoresOriginales(tarjeta);
                
                // Cerrar dropdown
                cerrarDropdown(tarjeta);
                
                console.log(`🔄 Filtro restaurado para ${tarjeta}`);
                
            } catch (error) {
                console.error('❌ Error restaurando filtro:', error);
            }
        }
        
        function cerrarDropdown(tarjeta) {
            const dropdown = document.querySelector(`[data-tarjeta="${tarjeta}"]`).closest('.dropdown');
            if (dropdown) {
                const bsDropdown = bootstrap.Dropdown.getInstance(dropdown.querySelector('.dropdown-toggle'));
                if (bsDropdown) {
                    bsDropdown.hide();
                }
            }
        }
        
        function obtenerNombreMes(numeroMes) {
            const nombresMeses = ['', 'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                                'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            return nombresMeses[numeroMes] || `Mes ${numeroMes}`;
        }
        
        console.log('✅ Sistema de filtros inicializado correctamente');
        
        // Función de prueba mejorada para verificar filtros
        window.probarFiltros = function() {
            console.log('🧪 Iniciando prueba completa de filtros...');
            
            // Probar filtro "Hoy" en cobranza
            console.log('🔍 Probando filtro "Hoy" en cobranza...');
            actualizarTarjetaIndividual('cobranza', 'hoy', '');
            
            setTimeout(() => {
                console.log('🔍 Probando filtro por mes en pagos...');
                actualizarTarjetaIndividual('pagos', 'mes_especifico', '1');
            }, 3000);
            
            setTimeout(() => {
                console.log('🔍 Probando filtro por mes en facturado...');
                actualizarTarjetaIndividual('facturado', 'mes_especifico', '12');
            }, 6000);
            
            setTimeout(() => {
                console.log('🔍 Probando filtro por mes en cobranza...');
                actualizarTarjetaIndividual('cobranza', 'mes_especifico', '6');
            }, 9000);
        };
        
        // Función de prueba individual
        window.probarFiltroIndividual = function(tarjeta, tipo, valor) {
            console.log(`🧪 Probando filtro individual: ${tarjeta} - ${tipo} - ${valor}`);
            actualizarTarjetaIndividual(tarjeta, tipo, valor);
        };
        
    });
    
    // Función para mostrar notificaciones mejorada
    function mostrarNotificacion(tipo, titulo, mensaje) {
        // Remover notificaciones anteriores
        const notificacionesExistentes = document.querySelectorAll('.notificacion-filtro');
        notificacionesExistentes.forEach(n => n.remove());
        
        // Crear elemento de notificación
        const notificacion = document.createElement('div');
        notificacion.className = `alert alert-${tipo === 'success' ? 'success' : tipo === 'error' ? 'danger' : 'info'} alert-dismissible fade show position-fixed notificacion-filtro`;
        notificacion.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 350px; max-width: 500px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);';
        
        // Icono según el tipo
        const iconos = {
            'success': '✅',
            'error': '❌',
            'info': 'ℹ️'
        };
        
        notificacion.innerHTML = `
            <div class="d-flex align-items-center">
                <span class="me-2" style="font-size: 1.2em;">${iconos[tipo] || 'ℹ️'}</span>
                <div>
                    <strong>${titulo}</strong><br>
                    <small>${mensaje}</small>
                </div>
                <button type="button" class="btn-close ms-auto" data-bs-dismiss="alert"></button>
            </div>
        `;
        
        // Agregar al DOM
        document.body.appendChild(notificacion);
        
        // Auto-remover después de 4 segundos
        setTimeout(() => {
            if (notificacion.parentNode) {
                notificacion.classList.remove('show');
                setTimeout(() => {
                    if (notificacion.parentNode) {
                        notificacion.remove();
                    }
                }, 300);
            }
        }, 4000);
    }
    
    // Actualizar tarjeta individual
    function actualizarTarjetaIndividual(tarjeta, tipo, valor = null) {
        const card = document.getElementById(`card-${tarjeta}`);
        const filtro = document.querySelector(`[data-tarjeta="${tarjeta}"]`);
        
        if (!card) {
            console.error(`❌ Tarjeta no encontrada: ${tarjeta}`);
            mostrarNotificacion('error', 'Error de Filtro', `Tarjeta ${tarjeta} no encontrada`);
            return;
        }
        
        // Validar parámetros
        if (!tipo) {
            console.error(`❌ Tipo de filtro no especificado para ${tarjeta}`);
            return;
        }
        
        console.log(`🔄 Actualizando tarjeta ${tarjeta} con filtro ${tipo}:${valor || 'sin valor'}`);
        
        // Aplicar animación de carga
        card.classList.add('loading');
        if (filtro) {
            filtro.disabled = true;
        }
        
        // Construir URL de la API con validación
        let url = `/api/tarjeta-filtro?tarjeta=${encodeURIComponent(tarjeta)}&tipo=${encodeURIComponent(tipo)}`;
        if (valor && valor !== '') {
            url += `&valor=${encodeURIComponent(valor)}`;
        }
        
        console.log(`🌐 URL de petición: ${url}`);
        console.log(`📊 Parámetros: tarjeta=${tarjeta}, tipo=${tipo}, valor=${valor}`);
        
        // Realizar petición AJAX con timeout
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 segundos timeout
        
        fetch(url, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
                'X-Requested-With': 'XMLHttpRequest'
            },
            credentials: 'same-origin', // Incluir cookies de sesión
            signal: controller.signal
        })
        .then(response => {
            clearTimeout(timeoutId);
            
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            return response.json();
        })
        .then(data => {
            if (data.success) {
                console.log(`✅ Datos recibidos para ${tarjeta}:`, data.data);
                
                // Validar datos recibidos
                if (!data.data || typeof data.data !== 'object') {
                    throw new Error('Datos inválidos recibidos del servidor');
                }
                
                // Aplicar animación de transición
                aplicarAnimacionFadeOut(card);
                
                setTimeout(() => {
                    try {
                        // Actualizar valores de la tarjeta
                        actualizarValoresTarjeta(tarjeta, data.data);
                        
                        // Aplicar animación de entrada
                        aplicarAnimacionFadeIn(card);
                        
                        // Mostrar notificación de éxito
                        mostrarNotificacion('success', 'Filtro Aplicado', `Datos actualizados para ${tarjeta}`);
                        
                    } catch (error) {
                        console.error(`❌ Error actualizando valores de ${tarjeta}:`, error);
                        mostrarNotificacion('error', 'Error de Actualización', 'No se pudieron actualizar los valores');
                    }
                }, 300);
                
            } else {
                console.error(`❌ Error en respuesta para ${tarjeta}:`, data.error);
                mostrarNotificacion('error', 'Error al Aplicar Filtro', data.error || 'Error desconocido del servidor');
            }
        })
        .catch(error => {
            clearTimeout(timeoutId);
            
            if (error.name === 'AbortError') {
                console.error(`⏰ Timeout para ${tarjeta}`);
                mostrarNotificacion('error', 'Timeout', 'La petición tardó demasiado tiempo');
            } else {
                console.error(`❌ Error de conexión para ${tarjeta}:`, error);
                mostrarNotificacion('error', 'Error de Conexión', 'No se pudo conectar con el servidor');
            }
        })
        .finally(() => {
            // Quitar animación de carga
            card.classList.remove('loading');
            if (filtro) {
                filtro.disabled = false;
            }
        });
    }
    
    // Actualizar valores de una tarjeta específica
    function actualizarValoresTarjeta(tarjeta, data) {
        console.log(`🔄 Actualizando valores para ${tarjeta}:`, data);
        
        try {
            if (tarjeta === 'cobranza') {
                const valorUsd = data.total_cobrar_usd || 0;
                const valorBs = data.total_cobrar_bs || 0;
                
                console.log(`💰 Cobranza - USD: ${valorUsd}, BS: ${valorBs}`);
                
                const elementoUsd = document.getElementById('valor-cobranza');
                const elementoBs = document.getElementById('valor-cobranza-bs');
                
                if (elementoUsd) {
                    elementoUsd.textContent = '$' + valorUsd.toLocaleString('es-ES', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });
                    console.log(`✅ Actualizado valor USD: ${elementoUsd.textContent}`);
                } else {
                    console.error('❌ Elemento valor-cobranza no encontrado');
                }
                
                if (elementoBs) {
                    elementoBs.textContent = valorBs.toLocaleString('es-ES', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    }) + ' Bs';
                    console.log(`✅ Actualizado valor BS: ${elementoBs.textContent}`);
                } else {
                    console.error('❌ Elemento valor-cobranza-bs no encontrado');
                }
                
            } else if (tarjeta === 'pagos') {
                const valorUsd = data.total_pagos_recibidos_usd || 0;
                const valorBs = data.total_pagos_recibidos_bs || 0;
                
                console.log(`💰 Pagos - USD: ${valorUsd}, BS: ${valorBs}`);
                
                const elementoUsd = document.getElementById('valor-pagos');
                const elementoBs = document.getElementById('valor-pagos-bs');
                
                if (elementoUsd) {
                    elementoUsd.textContent = '$' + valorUsd.toLocaleString('es-ES', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });
                    console.log(`✅ Actualizado valor USD: ${elementoUsd.textContent}`);
                } else {
                    console.error('❌ Elemento valor-pagos no encontrado');
                }
                
                if (elementoBs) {
                    elementoBs.textContent = valorBs.toLocaleString('es-ES', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    }) + ' Bs';
                    console.log(`✅ Actualizado valor BS: ${elementoBs.textContent}`);
                } else {
                    console.error('❌ Elemento valor-pagos-bs no encontrado');
                }
                
            } else if (tarjeta === 'facturado') {
                const valorUsd = data.total_facturado_usd || 0;
                const promedioUsd = data.promedio_nota_usd || 0;
                
                console.log(`💰 Nota de Entrega - Total: ${valorUsd}, Promedio: ${promedioUsd}`);
                
                const elementoTotal = document.getElementById('valor-facturado');
                const elementoPromedio = document.getElementById('valor-facturado-promedio');
                
                if (elementoTotal) {
                    elementoTotal.textContent = '$' + valorUsd.toLocaleString('es-ES', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });
                    console.log(`✅ Actualizado total: ${elementoTotal.textContent}`);
                } else {
                    console.error('❌ Elemento valor-facturado no encontrado');
                }
                
                if (elementoPromedio) {
                    elementoPromedio.textContent = 'Promedio: $' + promedioUsd.toLocaleString('es-ES', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });
                    console.log(`✅ Actualizado promedio: ${elementoPromedio.textContent}`);
                } else {
                    console.error('❌ Elemento valor-facturado-promedio no encontrado');
                }
            } else {
                console.error(`❌ Tarjeta desconocida: ${tarjeta}`);
            }
            
            console.log(`✅ Valores actualizados correctamente para ${tarjeta}`);
            
        } catch (error) {
            console.error(`❌ Error actualizando valores para ${tarjeta}:`, error);
            mostrarNotificacion('error', 'Error de Actualización', `No se pudieron actualizar los valores de ${tarjeta}`);
        }
    }
    
    // Restaurar valores originales (recargar la página para simplificar)
    function restaurarValoresOriginales(tarjeta) {
        // Esto recargaría la página para obtener los valores iniciales sin filtro
        // Para una experiencia más fluida, se podría hacer otra llamada a la API sin filtros
        // Por ahora, recargamos para asegurar que todos los estados se reseteen
        window.location.reload();
    }
    
    // Animaciones
    function aplicarAnimacionFadeOut(element) {
        element.classList.remove('fadeIn');
        element.classList.add('fadeOut');
    }
    
    function aplicarAnimacionFadeIn(element) {
        element.classList.remove('fadeOut');
        element.classList.add('fadeIn');
    }
    </script>

    <!-- Modal de Filtros Mejorado con Verde Neón -->
    <div class="modal fade" id="modalFiltros" tabindex="-1" aria-labelledby="modalFiltrosLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); border: 1px solid #00ff88; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,255,136,0.3);">
                <div class="modal-header" style="border-bottom: 1px solid #00ff88; background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%); border-radius: 15px 15px 0 0;">
                    <h5 class="modal-title" id="modalFiltrosLabel" style="color: #00ff88; font-weight: bold;">
                        <i class="fas fa-filter me-2"></i>Filtrar <span id="modal-tarjeta-titulo">Cuentas por Cobrar</span>
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" style="padding: 25px;">
                    <!-- Filtros Rápidos -->
                    <div class="mb-4">
                        <h6 class="mb-3" style="color: #00ff88; font-weight: bold;">
                            <i class="fas fa-bolt me-2"></i>Filtros Rápidos
                        </h6>
                        <div class="d-grid gap-2">
                            <button class="btn btn-outline-success btn-lg" onclick="aplicarFiltroRapido('todos')" style="border-color: #00ff88; color: #00ff88; font-weight: bold;">
                                <i class="fas fa-list me-2"></i>Ver Todos los Datos
                            </button>
                            <button class="btn btn-outline-warning btn-lg" onclick="aplicarFiltroRapido('hoy')" style="border-color: #ffc107; color: #ffc107; font-weight: bold;">
                                <i class="fas fa-calendar-day me-2"></i>Solo Hoy
                            </button>
                        </div>
                    </div>
                    
                    <hr style="border-color: #00ff88; margin: 25px 0;">
                    
                    <!-- Filtro por Mes -->
                    <div class="mb-4">
                        <h6 class="mb-3" style="color: #00ff88; font-weight: bold;">
                            <i class="fas fa-calendar me-2"></i>Filtrar por Mes
                        </h6>
                        <select class="form-select form-select-lg" id="selectMesModal" onchange="aplicarFiltroMes()" style="background: #2d2d2d; border-color: #00ff88; color: #fff;">
                            <option value="">Seleccionar mes...</option>
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>

                    <!-- Filtro por Año -->
                    <div class="mb-4">
                        <h6 class="mb-3" style="color: #00ff88; font-weight: bold;">
                            <i class="fas fa-calendar-alt me-2"></i>Filtrar por Año
                        </h6>
                        <select class="form-select form-select-lg" id="selectAnoModal" onchange="aplicarFiltroAno()" style="background: #2d2d2d; border-color: #00ff88; color: #fff;">
                            <option value="">Seleccionar año...</option>
                            <option value="2025">2025</option>
                            <option value="2024">2024</option>
                            <option value="2023">2023</option>
                            <option value="2022">2022</option>
                        </select>
                    </div>

                    <!-- Filtro por Fecha Específica -->
                    <div class="mb-4">
                        <h6 class="mb-3" style="color: #00ff88; font-weight: bold;">
                            <i class="fas fa-calendar-check me-2"></i>Fecha Específica
                        </h6>
                        <input type="date" class="form-control form-control-lg" id="inputFechaEspecifica" onchange="aplicarFiltroFechaEspecifica()" style="background: #2d2d2d; border-color: #00ff88; color: #fff;">
                    </div>
                </div>
                <div class="modal-footer" style="border-top: 1px solid #00ff88; background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); border-radius: 0 0 15px 15px;">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="background: #6c757d; border-color: #6c757d;">
                        <i class="fas fa-times me-1"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-danger" onclick="limpiarFiltros()" style="background: #dc3545; border-color: #dc3545;">
                        <i class="fas fa-eraser me-1"></i>Limpiar Filtros
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
    // Variable global para almacenar la tarjeta actual
    let tarjetaActual = '';

    // Función para actualizar filtro
    function actualizarFiltro(tarjeta, tipo, valor, textoMostrar) {
        try {
            // Obtener elementos del filtro
            const botonFiltro = document.querySelector(`[data-tarjeta="${tarjeta}"] .filtro-texto`);
            const botonCompleto = document.querySelector(`[data-tarjeta="${tarjeta}"]`);
            
            if (botonFiltro) {
                // Actualizar texto del botón
                botonFiltro.textContent = textoMostrar;
                console.log(`✅ Texto del botón actualizado: ${textoMostrar}`);
                
                // Agregar indicador visual de filtro activo
                if (botonCompleto) {
                    botonCompleto.classList.add('filtro-activo', 'filtro-pulsando');
                    
                    // Remover animación después de completarse
                    setTimeout(() => {
                        botonCompleto.classList.remove('filtro-pulsando');
                    }, 600);
                }
            }
            
            // Aplicar filtro
            actualizarTarjetaIndividual(tarjeta, tipo, valor);
            
        } catch (error) {
            console.error('❌ Error actualizando filtro:', error);
            alert('Error aplicando filtro: ' + error.message);
        }
    }

    // Función para restaurar filtro
    function restaurarFiltro(tarjeta) {
        try {
            // Obtener elementos del filtro
            const botonFiltro = document.querySelector(`[data-tarjeta="${tarjeta}"] .filtro-texto`);
            const botonCompleto = document.querySelector(`[data-tarjeta="${tarjeta}"]`);
            
            if (botonFiltro) {
                // Restaurar texto del botón
                botonFiltro.textContent = 'Todos';
                
                // Remover indicador visual de filtro activo
                if (botonCompleto) {
                    botonCompleto.classList.remove('filtro-activo');
                }
            }
            
            // Restaurar datos originales
            actualizarTarjetaIndividual(tarjeta, '', '');
            
        } catch (error) {
            console.error('❌ Error restaurando filtro:', error);
            alert('Error restaurando filtro: ' + error.message);
        }
    }

    // Función para actualizar tarjeta individual
    function actualizarTarjetaIndividual(tarjeta, tipo, valor) {
        try {
            console.log(`🔍 Actualizando tarjeta ${tarjeta} con tipo ${tipo} y valor ${valor}`);
            
            // Construir URL de la API
            let url = `/api/test-tarjeta-filtro?tarjeta=${tarjeta}`;
            if (tipo) {
                url += `&tipo=${tipo}`;
            }
            if (valor) {
                url += `&valor=${valor}`;
            }
            
            console.log(`🔍 URL de API: ${url}`);
            
            // Hacer petición a la API
            fetch(url)
                .then(response => {
                    console.log(`🔍 Respuesta de API: ${response.status}`);
                    return response.json();
                })
                .then(data => {
                    console.log(`🔍 Datos recibidos:`, data);
                    if (data.success) {
                        actualizarValoresTarjeta(tarjeta, data.data);
                    } else {
                        console.error('❌ Error en API:', data.error);
                        alert('Error en API: ' + data.error);
                    }
                })
                .catch(error => {
                    console.error('❌ Error en petición:', error);
                    alert('Error en petición: ' + error.message);
                });
                
        } catch (error) {
            console.error('❌ Error actualizando tarjeta individual:', error);
            alert('Error actualizando tarjeta: ' + error.message);
        }
    }

    // Función para actualizar valores de la tarjeta
    function actualizarValoresTarjeta(tarjeta, data) {
        try {
            console.log(`🔍 Actualizando valores para tarjeta ${tarjeta}:`, data);
            
            // Mapear tarjetas a sus elementos
            const mapeoTarjetas = {
                'cobranza': {
                    valor: 'total_cobrar_usd',
                    valorBs: 'total_cobrar_bs',
                    cantidad: 'cantidad_notas'
                },
                'pagos': {
                    valor: 'total_pagos_recibidos_usd',
                    valorBs: 'total_pagos_recibidos_bs',
                    cantidad: 'cantidad_notas'
                },
                'facturado': {
                    valor: 'total_facturado_usd',
                    valorBs: 'total_facturado_bs',
                    cantidad: 'cantidad_notas'
                }
            };
            
            const config = mapeoTarjetas[tarjeta];
            if (!config) {
                console.error('❌ Configuración no encontrada para tarjeta:', tarjeta);
                return;
            }
            
            // Actualizar valores USD
            const elementoValor = document.querySelector(`#card-${tarjeta} .stat-value`);
            if (elementoValor && data[config.valor] !== undefined) {
                elementoValor.textContent = `$${parseFloat(data[config.valor]).toLocaleString('es-VE', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            }
            
            // Actualizar valores BS
            const elementoValorBs = document.querySelector(`#card-${tarjeta} .stat-value-bs`);
            if (elementoValorBs && data[config.valorBs] !== undefined) {
                elementoValorBs.textContent = `${parseFloat(data[config.valorBs]).toLocaleString('es-VE', {minimumFractionDigits: 2, maximumFractionDigits: 2})} Bs`;
            }
            
            // Actualizar cantidad
            const elementoCantidad = document.querySelector(`#card-${tarjeta} .stat-cantidad`);
            if (elementoCantidad && data[config.cantidad] !== undefined) {
                elementoCantidad.textContent = `${data[config.cantidad]} notas`;
            }
            
            console.log(`✅ Valores actualizados para ${tarjeta}`);
            
        } catch (error) {
            console.error('❌ Error actualizando valores de tarjeta:', error);
            alert('Error actualizando valores: ' + error.message);
        }
    }

    // Función para abrir el modal de filtros
    function abrirModalFiltro(tarjeta) {
        console.log('🔍 Abriendo modal para tarjeta:', tarjeta);
        tarjetaActual = tarjeta;
        
        // Actualizar el título del modal según la tarjeta
        const titulos = {
            'cobranza': 'Cuentas por Cobrar',
            'pagos': 'Pagos Recibidos', 
            'facturado': 'Nota de Entrega'
        };
        
        document.getElementById('modal-tarjeta-titulo').textContent = titulos[tarjeta] || tarjeta;
        
        // Limpiar los campos del modal
        document.getElementById('selectMesModal').value = '';
        document.getElementById('selectAnoModal').value = '';
        document.getElementById('inputFechaEspecifica').value = '';
        
        // Cargar opciones reales del sistema
        cargarOpcionesFiltro();
        
        // Mostrar el modal
        const modalElement = document.getElementById('modalFiltros');
        console.log('🔍 Elemento modal encontrado:', modalElement);
        
        if (modalElement) {
            const modal = new bootstrap.Modal(modalElement);
            modal.show();
            console.log('✅ Modal mostrado correctamente');
        } else {
            console.error('❌ No se encontró el elemento modal');
        }
    }

    // Función para cargar opciones reales del sistema
    function cargarOpcionesFiltro() {
        console.log('🔍 Cargando opciones de filtro...');
        fetch('/api/test-opciones-filtro')
            .then(response => {
                console.log('🔍 Respuesta de API:', response.status);
                return response.json();
            })
            .then(data => {
                console.log('🔍 Datos recibidos:', data);
                if (data.success) {
                    // Cargar años disponibles
                    const selectAno = document.getElementById('selectAnoModal');
                    if (selectAno) {
                        selectAno.innerHTML = '<option value="">Seleccionar año...</option>';
                        data.data.años.forEach(año => {
                            const option = document.createElement('option');
                            option.value = año;
                            option.textContent = año;
                            selectAno.appendChild(option);
                        });
                        console.log('✅ Años cargados en select:', data.data.años);
                    } else {
                        console.error('❌ No se encontró selectAnoModal');
                    }
                    
                    console.log('✅ Opciones de filtro cargadas:', data.data);
                } else {
                    console.error('❌ Error en respuesta de API:', data.error);
                }
            })
            .catch(error => {
                console.error('❌ Error cargando opciones de filtro:', error);
            });
    }

    // Función para aplicar filtro rápido
    function aplicarFiltroRapido(tipo) {
        if (tipo === 'todos') {
            restaurarFiltro(tarjetaActual);
        } else if (tipo === 'hoy') {
            actualizarFiltro(tarjetaActual, 'hoy', '', 'Hoy');
        }
        
        // Cerrar el modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('modalFiltros'));
        modal.hide();
    }

    // Función para aplicar filtro por mes (automático)
    function aplicarFiltroMes() {
        const mes = document.getElementById('selectMesModal').value;
        if (mes) {
            const nombresMeses = ['', 'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                                'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            const nombreMes = nombresMeses[parseInt(mes)];
            actualizarFiltro(tarjetaActual, 'mes_especifico', mes, nombreMes);
            
            // Cerrar el modal después de un breve delay
            setTimeout(() => {
                const modal = bootstrap.Modal.getInstance(document.getElementById('modalFiltros'));
                if (modal) modal.hide();
            }, 500);
        }
    }

    // Función para aplicar filtro por año (automático)
    function aplicarFiltroAno() {
        const ano = document.getElementById('selectAnoModal').value;
        if (ano) {
            actualizarFiltro(tarjetaActual, 'año', ano, ano);
            
            // Cerrar el modal después de un breve delay
            setTimeout(() => {
                const modal = bootstrap.Modal.getInstance(document.getElementById('modalFiltros'));
                if (modal) modal.hide();
            }, 500);
        }
    }

    // Función para aplicar filtro por fecha específica
    function aplicarFiltroFechaEspecifica() {
        const fecha = document.getElementById('inputFechaEspecifica').value;
        if (fecha) {
            // Formatear la fecha para mostrar
            const fechaObj = new Date(fecha);
            const opciones = { year: 'numeric', month: 'long', day: 'numeric' };
            const fechaFormateada = fechaObj.toLocaleDateString('es-ES', opciones);
            
            actualizarFiltro(tarjetaActual, 'fecha_especifica', fecha, fechaFormateada);
            
            // Cerrar el modal después de un breve delay
            setTimeout(() => {
                const modal = bootstrap.Modal.getInstance(document.getElementById('modalFiltros'));
                if (modal) modal.hide();
            }, 500);
        }
    }

    // Función para aplicar filtro personalizado (automático)
    function aplicarFiltroPersonalizado() {
        const tipo = document.getElementById('selectTipoFiltro').value;
        const valor = document.getElementById('inputValorFiltro').value;
        
        // Si no hay tipo seleccionado, no hacer nada
        if (!tipo) {
            return;
        }
        
        // Si es "hoy", aplicar inmediatamente
        if (tipo === 'hoy') {
            actualizarFiltro(tarjetaActual, tipo, '', 'Hoy');
            
            // Cerrar el modal después de un breve delay
            setTimeout(() => {
                const modal = bootstrap.Modal.getInstance(document.getElementById('modalFiltros'));
                if (modal) modal.hide();
            }, 500);
            return;
        }
        
        // Para otros tipos, necesitamos valor
        if (!valor) {
            return;
        }
        
        let textoMostrar = '';
        if (tipo === 'mes') {
            const nombresMeses = ['', 'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                                'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            textoMostrar = nombresMeses[parseInt(valor)] || `Mes ${valor}`;
        } else if (tipo === 'año') {
            textoMostrar = `Año ${valor}`;
        } else if (tipo === 'semana') {
            textoMostrar = `Semana ${valor}`;
        }
        
        actualizarFiltro(tarjetaActual, tipo, valor, textoMostrar);
        
        // Cerrar el modal después de un breve delay
        setTimeout(() => {
            const modal = bootstrap.Modal.getInstance(document.getElementById('modalFiltros'));
            if (modal) modal.hide();
        }, 500);
    }

    // Función para limpiar todos los filtros
    function limpiarFiltros() {
        restaurarFiltro(tarjetaActual);
        
        // Limpiar los selectores del modal
        document.getElementById('selectMesModal').value = '';
        document.getElementById('selectAnoModal').value = '';
        document.getElementById('inputFechaEspecifica').value = '';
        
        // Cerrar el modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('modalFiltros'));
        modal.hide();
    }

    // Configurar event listeners para aplicación automática
    document.addEventListener('DOMContentLoaded', function() {
        // Configurar filtro personalizado
        const selectTipoFiltro = document.getElementById('selectTipoFiltro');
        const inputValorFiltro = document.getElementById('inputValorFiltro');
        
        if (selectTipoFiltro) {
            selectTipoFiltro.addEventListener('change', function() {
                if (this.value === 'hoy') {
                    inputValorFiltro.disabled = true;
                    inputValorFiltro.value = '';
                } else {
                    inputValorFiltro.disabled = false;
                }
            });
        }
        
        if (inputValorFiltro) {
            inputValorFiltro.addEventListener('input', function() {
                // Aplicar filtro automáticamente cuando se escribe
                if (this.value && selectTipoFiltro.value && selectTipoFiltro.value !== 'hoy') {
                    aplicarFiltroPersonalizado();
                }
            });
        }
    });
    </script>
    {% endblock %} 